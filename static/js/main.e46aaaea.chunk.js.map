{"version":3,"sources":["FullScreen.ts","browser.ts","Thumbnail.tsx","components/IOMarker.tsx","IOBar.tsx","BDVideo.tsx","AppAPI.ts","components/Help.tsx","components/ErrorDisplay.tsx","components/Splash.tsx","useAPI.ts","App.tsx","getVideoSize.ts","serviceWorker.js","index.js"],"names":["fullscreenElement","element","requestFullscreen","msRequestFullscreen","webkitRequestFullscreen","call","fsEnabled","document","fullscreenEnabled","msFullscreenEnabled","webkitFullscreenEnabled","fsExit","exitFullscreen","msExitFullscreen","webkitExitFullscreen","bind","browser","navigator","userAgent","indexOf","msBrowser","margins","edge","left","right","bottom","chrome","Thumbnail","_ref","src","offset","timestamp","_ref$width","width","video","React","useRef","useEffect","current","currentTime","react_default","a","createElement","className","ref","controls","autoPlay","loop","muted","style","diameter","IOMarker","color","height","viewBox","cx","cy","r","fill","IOBar","inTime","outTime","duration","ip","op","timelineWidth","ix","ox","Fragment","tryActions","actions","key","dragMargin","thumbnailMargin","useElement","_React$useState","useState","_React$useState2","Object","slicedToArray","setElement","useCallback","i","overlayDuration","BDVideo","showThumbnail","display","onLoad","onError","onDrag","size","onMouseOver","onMouseOut","objectFit","showOverlay","removeCallback","copyCallback","exclusiveCallback","inCallback","outCallback","speedCallback","_useElement","_useElement2","v","videoRef","_React$useState3","_React$useState4","overlayTimeout","setOverlayTimeout","_React$useState5","_React$useState6","thumbnailState","setThumbnailState","ontimeupdate","e","pastOut","out","beforeIn","in","addEventListener","focus","hoverThumbnail","layerY","undefined","videoPercentage","layerX","targetTime","playbackRate","onmouseover","startTime","onload","onerror","onloadeddata","onloadedmetadata","ondragstart","target","offsetY","preventDefault","onmousemove","clearTimeout","setTimeout","onmouseout","adjustDisplayTime","adjustment","arguments","length","shiftDisplayActions","arrowleft","arrowright","f","displayActions","m","assign","onKeyDown","ev","shiftKey","toLowerCase","objectSpread","pointerEvents","concat","file","name","onClick","IOBar_IOBar","Thumbnail_Thumbnail","url","draggable","objectFits","getDisplayCopy","id","uuid","getNext","list","removeIndex","toConsumableArray","slice","AppAPI","state","setState","applyToActive","modifier","prev","activeIndex","displays","applyToAll","map","setPartialState","partial","toggleHelp","showHelp","toggleThumbnails","showThumbnails","nextAspect","aspect","aspectRatios","nextFit","fit","setViewport","viewport","setExclusive","removeActive","copyDisplay","addCopies","copies","Array","updateDisplay","updates","setActiveIO","marker","defineProperty","adjustActivePlaybackRate","d","syncPlaybackRates","addFiles","files","newDisplays","URL","createObjectURL","triggerResize","firstLoad","handleDisplayError","errorDisplays","dismissErrors","distributeTimes","matchingDisplays","filter","orderedDisplays","t1","spacing","forEach","reorderDisplays","destVideo","dragSrc","si","di","findIndex","SHORTCUTS","DISCLAIMER","SelectInput","props","htmlFor","label","value","onChange","callback","choices","Help","toUpperCase","substr","objectFitCallback","AspectRatios","aspectRatio","toString","aspectRatioCallback","parseInt","ErrorDisplay","dismissCallback","type","onSubmit","Splash","useAPI","apiFactory","initialState","_useState","_useState2","useMemo","avg","arr","reduce","b","stopEvent","stopPropagation","App","api","globalActions","body","msFullscreenElement","webkitFullscreenElement","toggleFullscreen","h","s","t","x","handleResize","clientWidth","clientHeight","useLayoutEffect","window","onresize","ondragover","ondragenter","ondragleave","onkeydown","ctrlKey","ctrlDisplayActions","delete","c","o","ondrop","dataTransfer","droppedFiles","from","getRecommendedAspect","avgRatio","videoWidth","videoHeight","sort","Math","abs","ratio","pop","objects","constraints","bestArea","rows","cols","ceil","floor","y","vx","vy","videoArea","getVideoSize","onDrop","BDVideo_BDVideo","staggerCallback","components_Help","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","src_App","getElementById","process","href","origin","fetch","response","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.e46aaaea.chunk.js","sourcesContent":["export function fullscreenElement(element:HTMLElement) {\r\n\t(element.requestFullscreen || (element as any).msRequestFullscreen || (element as any).webkitRequestFullscreen).call(element)\r\n}\r\n\r\nconst fsEnabled = document.fullscreenEnabled || (document as any).msFullscreenEnabled || (document as any).webkitFullscreenEnabled\r\nconst fsExit = (document.exitFullscreen || (document as any).msExitFullscreen || (document as any).webkitExitFullscreen).bind(document)\r\nexport function toggleFullscreen(target:HTMLElement = document.body) {\r\n\tif (!fsEnabled) return\r\n\tconst fsElement = document.fullscreenElement || (document as any).msFullscreenElement || (document as any).webkitFullscreenElement\r\n\tif (fsElement) {\r\n\t\tfsExit()\r\n\t} else {\r\n\t\tfullscreenElement(target)\r\n\t}\r\n}\r\n","function getBrowser() {\r\n\tif (navigator.userAgent.indexOf(' Trident/') > -1) return 'IE'\r\n\tif (navigator.userAgent.indexOf(' Edge/') > -1) return 'Edge'\r\n\treturn 'Chrome'\r\n}\r\n\r\nconst videoMargins = {\r\n\t\"edge\": {\r\n\t\t\"left\": 116,\r\n\t\t\"right\": 220,\r\n\t\t\"bottom\": 24\r\n\t},\r\n\t\"chrome\": {\r\n\t\t\"left\": 24,\r\n\t\t\"right\": 24,\r\n\t\t\"bottom\": 16\r\n\t}\r\n}\r\n\r\n\r\nexport const browser = getBrowser()\r\nexport const msBrowser = [\"Edge\",\"IE\"].indexOf(browser) > -1\r\nexport const margins = videoMargins[browser === \"Chrome\" ? 'chrome' : 'edge']","import React from 'react'\r\nconst thumbnailWidth = 196\r\n\r\ntype ThumbnailProps = {\r\n\tsrc:string\r\n\toffset:number\r\n\ttimestamp:number\r\n\twidth?:number\r\n}\r\n\r\nexport const Thumbnail = ({src, offset, timestamp, width=thumbnailWidth}:ThumbnailProps) => {\r\n\tconst video = React.useRef<HTMLVideoElement>(null)\r\n\tReact.useEffect(() => {\r\n\t\tvideo.current!.currentTime = timestamp\r\n\t}, [timestamp])\r\n\r\n\treturn <video className=\"thumbnail\"\r\n\t\tref={video}\r\n\t\tcontrols={false} autoPlay={false} loop={false} muted={true}\r\n\t\tsrc={src} width={width} style={{left: offset - (width / 2)}} />\r\n}\r\n","import React from 'react'\r\nimport { margins } from '../browser'\r\n\r\ntype IOMarkerProps = {\r\n\toffset:number\r\n\tcolor:string\r\n}\r\n\r\nconst diameter = 10\r\nexport function IOMarker({offset, color}:IOMarkerProps) {\r\n\tconst style = {\r\n\t\tbottom: margins.bottom + (diameter/2),\r\n\t\tleft: margins.left + offset - (diameter/2)\r\n\t}\r\n\treturn <svg className=\"iomarker\"\r\n\t\twidth={diameter} height={diameter}\r\n\t\tviewBox={`0 0 2 2`} style={style}>\r\n\t\t<circle cx={1} cy={1} r={1} fill={color} />\r\n\t</svg>\r\n}","import React from 'react'\r\nimport { IOMarker } from './components/IOMarker'\r\nimport { margins } from './browser'\r\n\r\ntype IOBarProps = {\r\n\tinTime?:number\r\n\toutTime?:number\r\n\tvideo:HTMLVideoElement\r\n}\r\n\r\nexport const IOBar = ({inTime, outTime, video}:IOBarProps) => {\r\n\tif (!(inTime || outTime)) return null\r\n\tconst duration = video.duration\r\n\tconst ip = inTime || 0\r\n\tconst op = outTime || duration\r\n\tconst timelineWidth = video.width - margins.left - margins.right\r\n\tconst ix = (ip / duration) * timelineWidth\r\n\tconst ox = (op / duration) * timelineWidth\r\n\treturn <>\r\n\t\t<IOMarker offset={ix} color=\"gold\" />\r\n\t\t<IOMarker offset={ox} color=\"gold\" />\r\n\t</>\r\n}","import React from 'react'\r\nimport { ObjectFitProperty } from 'csstype'\r\nimport { fullscreenElement } from './FullScreen'\r\nimport { margins, browser, msBrowser } from './browser'\r\nimport { Thumbnail } from './Thumbnail'\r\nimport { IOBar } from './IOBar'\r\nimport './BDVideo.css'\r\n\r\nexport type Display = {\r\n\tid:string\r\n\tfile:File\r\n\turl:string\r\n\tstartTime?:number\r\n\tin?:number\r\n\tout?:number\r\n\tvideo?:HTMLVideoElement\r\n\ttriggerResize:boolean\r\n\tplaybackRate:number\r\n}\r\n\r\ntype BDVideoProps = {\r\n\tdisplay:Display\r\n\tobjectFit:ObjectFitProperty\r\n\tsize: {\r\n\t\twidth:number\r\n\t\theight:number\r\n\t}\r\n\tshowOverlay:boolean\r\n\tshowThumbnail:boolean\r\n\tonMouseOver:()=>void\r\n\tonMouseOut:()=>void\r\n\tonLoad:()=>void\r\n\tonError:()=>void\r\n\tonDrag:(display:Display)=>void\r\n\tremoveCallback:()=>void,\r\n\tcopyCallback:()=>void,\r\n\texclusiveCallback:()=>void,\r\n\tstaggerCallback:()=>void,\r\n\tinCallback:()=>void,\r\n\toutCallback:()=>void,\r\n\tspeedCallback:(adjustment:number)=>void\r\n}\r\n\r\nconst tryActions = (actions:{[key:string]:()=>void}, key:string) =>\r\n\tkey in actions && actions[key]()\r\n\r\ntype ThumbnailState = {\r\n\toffset:number // x-axis mouse position\r\n\ttimestamp:number\r\n}\r\n\r\nconst dragMargin = 80\r\nconst thumbnailMargin = margins.bottom + 8\r\n\r\nconst useElement = <T,>() => {\r\n\tconst [element, setElement] = React.useState<T>()\r\n\tconst ref = React.useCallback((i:T)=>setElement(i), [])\r\n\treturn [element!, ref] as const\r\n}\r\n\r\nconst overlayDuration = 3000\r\nexport function BDVideo({showThumbnail, display,\r\n\tonLoad, onError, onDrag, size, onMouseOver, onMouseOut,\r\n\tobjectFit, showOverlay, removeCallback, copyCallback, exclusiveCallback,\r\n\tinCallback, outCallback, speedCallback}:BDVideoProps) {\r\n\r\n\tconst [v, videoRef] = useElement<HTMLVideoElement>()\r\n\r\n\tconst [overlayTimeout, setOverlayTimeout] = React.useState<NodeJS.Timeout|undefined>()\r\n\tconst [thumbnailState, setThumbnailState] = React.useState<ThumbnailState|undefined>()\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tv.ontimeupdate = e => {\r\n\t\t\tconst pastOut = display.out && display.out< v.currentTime\r\n\t\t\tconst beforeIn = display.in && display.in > v.currentTime\r\n\t\t\tif (pastOut || beforeIn) v.currentTime = display.in || 0\r\n\t\t}\r\n\t\tv.addEventListener('mouseover', e=>v.focus())\r\n\t}, [display.in, display.out, v])\r\n\r\n\tconst hoverThumbnail = React.useCallback((e:MouseEvent) => {\r\n\t\tconst distanceFromBottom = v.height - e.layerY\r\n\t\tif (distanceFromBottom > thumbnailMargin) {\r\n\t\t\treturn setThumbnailState(undefined)\r\n\t\t}\r\n\t\tconst timelineWidth = v.width - margins.left - margins.right\r\n\t\tconst videoPercentage = (e.layerX - margins.left) / timelineWidth \r\n\t\tif (videoPercentage < 0 || videoPercentage > 1) {\r\n\t\t\treturn setThumbnailState(undefined)\r\n\t\t}\r\n\t\tconst targetTime = v.duration * videoPercentage\r\n\t\tsetThumbnailState({\r\n\t\t\toffset: e.layerX,\r\n\t\t\ttimestamp: targetTime\r\n\t\t})\r\n\t}, [v])\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tv.playbackRate = display.playbackRate\r\n\t}, [display.playbackRate, v])\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tv.onmouseover = showThumbnail && browser !== 'IE' ? hoverThumbnail : null\r\n\t}, [showThumbnail, hoverThumbnail, v])\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tdisplay.video = v\r\n\t\tif (display.startTime) {\r\n\t\t\tv.onload = () => { v.currentTime = display.startTime! }\r\n\t\t} else {\r\n\t\t\tv.onerror = onError\r\n\t\t\tv.onloadeddata = e => v.currentTime = v.duration / 2\r\n\t\t\tv.onloadedmetadata = onLoad\r\n\t\t}\r\n\t\tv.ondragstart = e => {\r\n\t\t\tconst target = e.target! as HTMLVideoElement\r\n\t\t\tconst distanceFromBottom = target.height - e.offsetY\r\n\t\t\tif (distanceFromBottom < dragMargin) {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tonDrag(display)\r\n\t\t}\r\n\t\tv.onmousemove = e => {\r\n\t\t\tshowThumbnail && browser !== 'IE' && hoverThumbnail(e)\r\n\t\t\toverlayTimeout && clearTimeout(overlayTimeout)\r\n\t\t\tsetOverlayTimeout(setTimeout(()=>setOverlayTimeout(undefined), overlayDuration))\r\n\t\t}\r\n\t\tv.onmouseout = e => {\r\n\t\t\tsetThumbnailState(undefined)\r\n\t\t}\r\n\t}, [display, hoverThumbnail, onDrag, onError, onLoad, overlayTimeout, showThumbnail, v])\r\n\r\n\tconst adjustDisplayTime = (adjustment:number, percentage:boolean = false) => {\r\n\t\tif (percentage) adjustment = v.duration * adjustment\r\n\t\tv.currentTime = (v.currentTime + adjustment + v.duration) % v.duration\r\n\t}\r\n\r\n\tconst shiftDisplayActions = {\r\n\t\t\"arrowleft\": () => adjustDisplayTime(-.1, true),\r\n\t\t\"arrowright\": () => adjustDisplayTime(.1, true),\r\n\t\t\"f\": () => v && fullscreenElement(v)\r\n\t}\r\n\tconst displayActions = {\r\n\t\t\"m\": () => { v.muted = !v.muted },\r\n\t\t\"arrowleft\": () => adjustDisplayTime(-60),\r\n\t\t\"arrowright\": () => adjustDisplayTime(60),\r\n\t}\r\n\r\n\tconst handleDisplayKeyDown = (ev:React.KeyboardEvent<HTMLDivElement>) =>\r\n\t\ttryActions(\r\n\t\t\tev.shiftKey ? shiftDisplayActions : displayActions,\r\n\t\t\tev.key.toLowerCase()\r\n\t\t)\r\n\r\n\treturn <div className=\"display\" {...size} onMouseOver={onMouseOver} onMouseOut={onMouseOut} onKeyDown={handleDisplayKeyDown}>\r\n\t\t{overlayTimeout && <div className=\"display-border\" style={{...size, pointerEvents: msBrowser ? 'none' : 'auto'}}>\r\n\t\t\t{`${display.file.name}${display.playbackRate === 1 ? \"\" : \" (\"+display.playbackRate+\"x)\"}`}\r\n\t\t</div>}\r\n\t\t{overlayTimeout && <div className=\"display-controls\">\r\n\t\t\t<button onClick={removeCallback}>X</button>\r\n\t\t\t<button onClick={copyCallback}>C</button>\r\n\t\t\t<button onClick={exclusiveCallback}>E</button>\r\n\t\t\t<button onClick={inCallback}>I</button>\r\n\t\t\t<button onClick={outCallback}>O</button>\r\n\t\t\t<button onClick={() => speedCallback(2)}>&raquo;</button>\r\n\t\t\t<button onClick={() => speedCallback(0.5)}>&laquo;</button>\r\n\t\t</div>}\r\n\t\t{showOverlay && <IOBar inTime={display.in} outTime={display.out} video={v} />}\r\n\t\t{showThumbnail && thumbnailState && <Thumbnail src={display.url} {...thumbnailState} />}\r\n\t\t<video controls={true} autoPlay={true} loop={true} muted={true} ref={videoRef}\r\n\t\t\tsrc={display.url} draggable={!msBrowser} {...size} style={{objectFit}} />\r\n\t</div>\r\n}","import uuid from 'uuid'\r\nimport {ObjectFitProperty} from 'csstype'\r\nimport {ApiFactoryProps} from './useAPI'\r\nimport { Display } from './BDVideo'\r\nimport aspectRatios from './AspectRatios.json'\r\n\r\nexport const objectFits:ObjectFitProperty[] = ['contain', 'cover', 'fill', 'scale-down']\r\nexport type AspectRatio = typeof aspectRatios[number]\r\n\r\ntype Viewport = {\r\n\twidth:number\r\n\theight:number\r\n}\r\ntype AppState = {\r\n\tshowHelp:boolean\r\n\tshowThumbnails:boolean\r\n\tfirstLoad:boolean\r\n\r\n\tfit:ObjectFitProperty\r\n\taspect:AspectRatio\r\n\r\n\tactiveIndex?:number\r\n\tdragSrc?:Display\r\n\r\n\tdisplays:Display[]\r\n\terrorDisplays:Display[]\r\n\r\n\tviewport?:Viewport\r\n}\r\n\r\nconst getDisplayCopy = (display:Display) => ({\r\n\t...display,\r\n\tid: uuid(),\r\n\tstartTime: display.video ? (display.video.currentTime + 60) % display.video.duration : 0\r\n})\r\n\r\nconst getNext = <T,>(list:T[], current:T) =>\r\n\tlist[(list.indexOf(current) + 1) % list.length]\r\n\r\nconst removeIndex = <T,>(list:T[], i:number) =>\r\n\t[...list.slice(0,i), ...list.slice(i+1)]\r\n\r\nexport const AppAPI = ({state, setState}:ApiFactoryProps<AppState>) => {\r\n\tconst setPartialState = (partial:Partial<AppState>) => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\t...partial\r\n\t\t}))\r\n\t}\r\n\tconst toggleHelp = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tshowHelp: !prev.showHelp\r\n\t\t}))\r\n\t}\r\n\r\n\tconst toggleThumbnails = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tshowThumbnails: !prev.showThumbnails\r\n\t\t}))\r\n\t}\r\n\r\n\tconst nextAspect = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\taspect: getNext(aspectRatios, prev.aspect)\r\n\t\t}))\r\n\t}\r\n\r\n\tconst nextFit = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tfit: getNext([...objectFits], prev.fit)\r\n\t\t}))\r\n\t}\r\n\r\n\tconst setViewport = (viewport:Viewport) => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tviewport\r\n\t\t}))\r\n\t}\r\n\r\n\tconst setExclusive = (i:number) => {\r\n\t\tsetState(prev => {\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tactiveIndex: 0,\r\n\t\t\t\tdisplays: [prev.displays[i]]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst removeActive = () => {\r\n\t\tsetState(prev => {\r\n\t\t\tif (prev.activeIndex === undefined) return prev\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: removeIndex(prev.displays, prev.activeIndex),\r\n\t\t\t\tactiveIndex: undefined\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst reorderDisplays = (destVideo:EventTarget) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst src = prev.dragSrc\r\n\t\t\tif (src === undefined) return prev\r\n\t\t\tconst displays = prev.displays\r\n\t\t\tconst si = displays.indexOf(src)\r\n\t\t\tconst di = displays.findIndex(i => i.video === destVideo) || displays.length - 1\r\n\t\t\tconst newDisplays = si > di ? [\r\n\t\t\t\t...displays.slice(0, di),\r\n\t\t\t\tdisplays[si],\r\n\t\t\t\t...displays.slice(di, si),\r\n\t\t\t\t...displays.slice(si+1)\r\n\t\t\t] : [\r\n\t\t\t\t...displays.slice(0, si),\r\n\t\t\t\t...displays.slice(si+1, di+1),\r\n\t\t\t\tdisplays[si],\r\n\t\t\t\t...displays.slice(di+1)\r\n\t\t\t]\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: newDisplays\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst copyDisplay = (i:number) => {\r\n\t\tsetState(prev => {\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: [...prev.displays, getDisplayCopy(prev.displays[i])]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst addCopies = (copies:number) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst i = prev.activeIndex\r\n\t\t\tif (i === undefined) return prev\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: [\r\n\t\t\t\t\t...prev.displays,\r\n\t\t\t\t\t...[...Array(copies)].map(()=>getDisplayCopy(prev.displays[i]))]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst updateDisplay = (i:number, updates:Partial<Display>) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst displays = [...prev.displays]\r\n\t\t\t// shallow effect only!\r\n\t\t\tdisplays[i] = {...displays[i], ...updates}\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t// lots of issues because active is an object, not the object in question\r\n\tconst applyToActive = (modifier:(display:Display)=>Partial<Display>) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst i = prev.activeIndex\r\n\t\t\tif (i === undefined) return prev\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: [\r\n\t\t\t\t\t...prev.displays.slice(0, i),\r\n\t\t\t\t\t{...prev.displays[i], ...modifier(prev.displays[i])},\r\n\t\t\t\t\t...prev.displays.slice(i+1)\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst applyToAll = (modifier:(display:Display)=>Partial<Display>) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst displays = prev.displays.map(i=>({...i, ...modifier(i)}))\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\t...displays\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst setActiveIO = (marker:'in'|'out') => {\r\n\t\tapplyToActive(display => ({\r\n\t\t\t[marker]: display[marker] === undefined\r\n\t\t\t\t? display.video!.currentTime\r\n\t\t\t\t: undefined\r\n\t\t}))\r\n\t}\r\n\r\n\tconst adjustActivePlaybackRate = (adjustment:number) => {\r\n\t\tapplyToActive(d=>({playbackRate: d.playbackRate * adjustment}))\r\n\t}\r\n\r\n\tconst syncPlaybackRates = (playbackRate:number) => {\r\n\t\tapplyToAll(d=>({playbackRate}))\r\n\t}\r\n\r\n\tconst addFiles = (files:File[]) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst newDisplays = files.map(file => ({\r\n\t\t\t\tid: uuid(),\r\n\t\t\t\tfile,\r\n\t\t\t\turl: URL.createObjectURL(file),\r\n\t\t\t\ttriggerResize: prev.firstLoad,\r\n\t\t\t\tplaybackRate: 1\r\n\t\t\t}))\r\n\t\t\treturn ({\r\n\t\t\t\t...prev,\r\n\t\t\t\tfirstLoad: false,\r\n\t\t\t\tshowHelp: prev.showHelp && newDisplays.length === 0,\r\n\t\t\t\tdisplays: [...prev.displays, ...newDisplays]\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tconst handleDisplayError = () => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst i = prev.activeIndex\r\n\t\t\tif (i === undefined) return prev\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: removeIndex(prev.displays, i),\r\n\t\t\t\terrorDisplays: [...prev.errorDisplays, prev.displays[i]]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst dismissErrors = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\terrorDisplays: []\r\n\t\t}))\r\n\t}\r\n\r\n\r\n\tconst distributeTimes = (i:number) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst display = prev.displays[i]\r\n\t\t\tconst {video, file} = display\r\n\t\t\tif (!video) return prev\r\n\r\n\t\t\tconst matchingDisplays = prev.displays.filter(i => i.file === file)\r\n\t\t\t// start with target display so it keeps its current time, bump up from there looping back to start\r\n\t\t\tconst orderedDisplays = [display, ...matchingDisplays.slice(i+1), ...matchingDisplays.slice(0, i)]\r\n\r\n\t\t\tconst t1 = video.currentTime\r\n\t\t\tconst duration = video.duration\r\n\t\t\tconst spacing = duration / orderedDisplays.length\r\n\t\t\torderedDisplays.forEach((v, i) => {\r\n\t\t\t\tconst targetTime = t1 + (spacing * i)\r\n\t\t\t\t// loop time back to beginning once we exceed end of video\r\n\t\t\t\tv.video!.currentTime = targetTime % duration\r\n\t\t\t})\r\n\t\t\treturn prev\r\n\t\t})\r\n\t}\r\n\r\n\treturn {\r\n\t\t...state,\r\n\t\tsetPartialState,\r\n\t\ttoggleHelp, toggleThumbnails,\r\n\t\tnextAspect,\r\n\t\tnextFit,\r\n\t\tsetViewport,\r\n\t\tsetExclusive,\r\n\t\tremoveActive,\r\n\t\tcopyDisplay, addCopies,\r\n\r\n\t\tupdateDisplay,\r\n\t\tapplyToActive, applyToAll,\r\n\r\n\t\tsetActiveIO, adjustActivePlaybackRate,\r\n\t\tsyncPlaybackRates,\r\n\r\n\t\taddFiles,\r\n\t\thandleDisplayError, dismissErrors,\r\n\r\n\t\tdistributeTimes,\r\n\r\n\t\treorderDisplays\r\n\t}\r\n}","import React from 'react'\r\nimport './Help.css'\r\nimport { ObjectFitProperty } from \"csstype\"\r\nimport {objectFits} from '../AppAPI'\r\nimport AspectRatios from '../AspectRatios.json'\r\ntype AspectRatio = typeof AspectRatios[number]\r\n\r\nconst SHORTCUTS = <section id=\"shortcuts\">\r\n\t<h2>Shortcuts</h2><ol>\r\n\t\t<li><em>C:</em> Clone video (+1m)</li>\r\n\t\t<li><em>D:</em> Distribute times</li>\r\n\t\t<li><em>E:</em> Remove everything else</li>\r\n\t\t<li><em>F:</em> Toggle fullscreen</li>\r\n\t\t<li><em>Shift+F:</em> Fullscreen video</li>\r\n\t\t<li><em>H:</em> Toggle help</li>\r\n\t\t<li><em>I:</em> Toggle in point</li>\r\n\t\t<li><em>O:</em> Toggle out point</li>\r\n\t\t<li><em>M:</em> Toggle mute</li>\r\n\t\t<li><em>R:</em> Remove video</li>\r\n\t\t<li><em>S:</em> Change video scaling</li>\r\n\t\t<li><em>X:</em> Change aspect ratio</li>\r\n\t\t<li><em>← →:</em> Skip 1m</li>\r\n\t\t<li><em>Shift ← →:</em> Skip 10%</li>\r\n\t\t<li><em>Ctrl ← →:</em> Change speed</li>\r\n\t\t<li><em>Shift+S</em> Sync speeds</li>\r\n\t\t<li><em>Ctrl+W:</em> Close tab</li>\r\n\t\t<li><em>O,O:</em> Restart video</li>\r\n\t\t<li><em>2-9:</em> Fill 2-9 size grid</li>\r\n\t\t<li><em>Drag+Drop:</em> Reorder videos</li>\r\n\t</ol>\r\n</section>\r\n\r\nconst DISCLAIMER = <footer>\r\n\t<h2>Privacy Disclaimer</h2>\r\n\t<p>This tool records <b>no</b> filenames, screen grabs, or any other methods of identifying the actual contents of any video.  Only metadata about a video's format (codec, file size, resolution, and duration) may be recorded.</p>\r\n</footer>\r\n\r\ntype HelpSettingsProps = {\r\n\tobjectFit:ObjectFitProperty\r\n\tobjectFitCallback:(v:ObjectFitProperty)=>void\r\n\taspectRatio:AspectRatio\r\n\taspectRatioCallback:(v:AspectRatio)=>void\r\n}\r\n\r\n// const getAR = (v:AspectRatio) => `${v.ratio.toFixed(2)} / ${v.name}`\r\n\r\nexport function Help(props:HelpSettingsProps) {\r\n\treturn <section id=\"help\">\r\n\t\t<h2>Usage</h2>\r\n\t\t<p>Drag and drop any number of videos to auto-play in an optimally arranged grid.</p>\r\n\t\t<section id=\"settings\">\r\n\t\t\t<h2>Settings</h2>\r\n\t\t\t<form>\r\n\t\t\t\t<SelectInput\r\n\t\t\t\t\tname=\"objectScale\" label=\"Video Fit/Fill\"\r\n\t\t\t\t\tvalue={props.objectFit} choices={objectFits.map(v => <option key={v} value={v}>{v[0].toUpperCase()+v.substr(1)}</option>)}\r\n\t\t\t\t\tcallback={v=>props.objectFitCallback(v as ObjectFitProperty)} /><br />\r\n\t\t\t\t<SelectInput\r\n\t\t\t\t\tname=\"aspectRatio\" label=\"Aspect Ratio\"\r\n\t\t\t\t\tvalue={AspectRatios.indexOf(props.aspectRatio).toString()}\r\n\t\t\t\t\tchoices={AspectRatios.map((v, i) => <option key={i} value={i}>{v.name}</option>)}\r\n\t\t\t\t\tcallback={i=>props.aspectRatioCallback(AspectRatios[parseInt(i)])} /><br />\r\n\t\t\t</form>\r\n\t\t</section>\r\n\t\t{SHORTCUTS}\r\n\t\t{DISCLAIMER}\r\n\t</section>\r\n}\r\n\r\nfunction SelectInput(props:{name:string, label:string, value:string, choices:JSX.Element[], callback:(val:string)=>void}) {\r\n\treturn <>\r\n\t\t<label htmlFor={props.name}>{props.label}</label>\r\n\t\t<select name={props.name} value={props.value} onChange={e => props.callback(e.target.value)}>\r\n\t\t\t{props.choices}\r\n\t\t</select>\r\n\t</>\r\n}\r\n\r\n// type NumInputProps = {\r\n// \tvalue:number\r\n// \tname:string\r\n// \tlabel:string\r\n// \tcallback:(num:number)=>void\r\n// }\r\n// const NumInput = ({value,name,label,callback}:NumInputProps) => <>\r\n// \t<label htmlFor={name}>{label}</label>\r\n// \t<input type=\"number\" min={0} maxLength={3} name={name} value={value} onChange={e => callback(parseFloat(e.target.value))} />\r\n// </>\r\n\r\nexport default Help","import React from 'react'\r\nimport {Display} from '../BDVideo'\r\n\r\ntype ErrorDisplayProps = {\r\n\terrorDisplays:Display[]\r\n\tdismissCallback:()=>void\r\n}\r\nexport function ErrorDisplay({errorDisplays, dismissCallback}:ErrorDisplayProps) {\r\n\treturn <section id=\"errors\">\r\n\t\t<h2>Errors</h2><ol>\r\n\t\t\t{errorDisplays.map((display, i) => <li key={i}>{display.file.name} ({display.file.type})</li>)}\r\n\t\t</ol>\r\n\t\t<p>Only videos supported by your web browser will play successfully.  <code>.mp4</code> and <code>.webm</code> files are good bets.</p>\r\n\t\t<form onSubmit={dismissCallback}><button>Dismiss</button></form>\r\n\t</section>\r\n}\r\n","import React from 'react'\r\n\r\n// TODO: add logo\r\nexport function Splash() {\r\n\treturn <section id=\"splash\">\r\n\t\t<p>Auto-play any number of videos or copies of videos in an optimally arranged grid with simple drag-and-drop.  Videos start half-way in and loop, ensuring immediate, continuous immersion, great for scouring surveillance footage, finding the best highlights from your last gaming stream, and more!</p>\r\n\t\t<p>Find your favourite moments quickly with thumbnail scrubbing and keyboard shortcuts to jump ahead in time 1m (→) or 10% (Shift →), or adjust playback speed (Ctrl →).</p>\r\n\t\t<p>Use shortcut keys to rapidly (c)opy or (r)emove displays, set (i)n/(o)ut loop points, (f)ullscreen the display, toggle (m)ute, etc.</p>\r\n\t\t{/* <img src=\"clipart/surveillance.jpg\" alt=\"Surveillance\" />\r\n\t\t<img src=\"clipart/television.jpg\" alt=\"Television\" /> */}\r\n\t</section>\r\n}\r\n\r\n","import {useState, useMemo} from 'react'\r\n\r\nexport type ApiFactoryProps<T> = {\r\n\tstate:T,\r\n\tsetState:(callback:(prevState:T)=>T)=>void\r\n}\r\n\r\nexport const useAPI = <T,V>(apiFactory:(props:ApiFactoryProps<T>)=>V, initialState:T) => {\r\n\tlet [state, setState] = useState(initialState)\r\n\treturn useMemo(\r\n\t\t()=>apiFactory({ state, setState }),\r\n\t\t[state, apiFactory]\r\n\t)\r\n}\r\n\r\n","// TODO: import only required polyfills\n// import 'react-app-polyfill/ie11'\n// import '@babel/polyfill'\n// import 'core-js/modules/es6.array.from'\n\n// TODO: refence react as third party library on cdn?\nimport React from 'react'\nimport { BDVideo } from './BDVideo'\nimport Help from './components/Help'\nimport { toggleFullscreen } from './FullScreen'\nimport { ErrorDisplay } from './components/ErrorDisplay'\nimport { Splash } from './components/Splash'\nimport aspectRatios from './AspectRatios.json'\nimport './App.css'\n\nimport {AppAPI, objectFits} from './AppAPI'\nimport { useAPI } from './useAPI'\nimport {getVideoSize} from './getVideoSize'\n\nconst avg = (arr:number[]) => arr.reduce((a, b) => a + b, 0) / arr.length\n\nfunction stopEvent(e:Event) {\n\te.preventDefault()\n\te.stopPropagation()\n}\n\nfunction tryActions(actions:{[key:string]:()=>void}, key:string) {\n\tkey in actions && actions[key]()\n}\n\nfunction App() {\n\tconst api = useAPI(AppAPI, {\n\t\tshowHelp: true,\n\t\tshowThumbnails: true,\n\t\tfirstLoad: true,\n\t\tdisplays: [],\n\t\terrorDisplays: [],\n\t\taspect: aspectRatios[0],\n\t\tfit: objectFits[0]\n\t})\n\n\tconst viewport = React.useRef<HTMLElement>(null)\n\n\tconst globalActions = {\n\t\t\"f\": () => toggleFullscreen(),\n\t\t\"h\": api.toggleHelp,\n\t\t\"s\": api.nextFit,\n\t\t\"t\": api.toggleThumbnails,\n\t\t\"x\": api.nextAspect\n\t}\n\n\tconst handleResize = () => {\n\t\tconst i = viewport.current!\n\t\tapi.setViewport({\n\t\t\twidth: i.clientWidth,\n\t\t\theight: i.clientHeight\n\t\t})\n\t}\n\tReact.useLayoutEffect(() => {\n\t\twindow.onresize = () => handleResize()\n\t\thandleResize()\n\t\t// eslint-disable-next-line\n\t}, [])\n\n\tReact.useEffect(() => {\n\t\tdocument.ondragover = stopEvent\n\t\tdocument.ondragenter = stopEvent\n\t\tdocument.ondragleave = stopEvent\n\t}, [])\n\n\tReact.useEffect(() => {\n\t\twindow.onkeydown = (ev) => {\n\t\t\tconst key = ev.key.toLowerCase()\n\t\t\tif (key in globalActions && !ev.shiftKey && !ev.ctrlKey) {\n\t\t\t\treturn globalActions[key as keyof typeof globalActions]()\n\t\t\t}\n\n\t\t\tconst i = api.activeIndex\n\t\t\tif (i === undefined) return\n\t\t\tconst ctrlDisplayActions = {\n\t\t\t\t\"arrowleft\": () => api.adjustActivePlaybackRate(0.5),\n\t\t\t\t\"arrowright\": () => api.adjustActivePlaybackRate(2)\n\t\t\t}\n\t\t\tconst shiftDisplayActions = {\n\t\t\t\t\"s\": () => api.syncPlaybackRates(api.displays[i].video!.playbackRate),\n\t\t\t}\n\t\t\tconst displayActions = {\n\t\t\t\t\"delete\": api.removeActive,\n\t\t\t\t\"c\": () => api.copyDisplay(i),\n\t\t\t\t\"d\": () => api.distributeTimes(i),\n\t\t\t\t\"e\": () => api.activeIndex && api.setExclusive(api.activeIndex),\n\t\t\t\t\"i\": () => api.setActiveIO('in'),\n\t\t\t\t\"o\": () => api.setActiveIO('out'),\n\t\t\t\t\"r\": api.removeActive,\n\t\t\t}\n\n\t\t\tif (ev.shiftKey) {\n\t\t\t\ttryActions(shiftDisplayActions, key)\n\t\t\t} else if (ev.ctrlKey) {\n\t\t\t\ttryActions(ctrlDisplayActions, key)\n\t\t\t} else {\n\t\t\t\ttryActions(displayActions, key)\n\t\t\t\tif (key >= \"2\" && key <= \"9\") {\n\t\t\t\t\tapi.addCopies(parseInt(key))\n\t\t\t\t\tapi.distributeTimes(i)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, [api, globalActions])\n\n\tReact.useEffect(() => {\n\t\tdocument.ondrop = e => {\n\t\t\tstopEvent(e)\n\t\t\tif (!e.dataTransfer) return\n\t\t\tconst droppedFiles = e.dataTransfer.files as FileList\n\t\t\tapi.addFiles(Array.from(droppedFiles))\n\t\t}\n\t}, [api])\n\n\tconst getRecommendedAspect = React.useCallback(() => {\n\t\tconst avgRatio = avg(api.displays.map(i => i.video!.videoWidth / i.video!.videoHeight))\n\t\tconst closestRatio = [...aspectRatios].sort((a, b) => Math.abs(avgRatio - b.ratio) - Math.abs(avgRatio - a.ratio)).pop()!\n\t\treturn closestRatio\n\t}, [api.displays])\n\n\tconst size = React.useMemo(() => getVideoSize(\n\t\tapi.aspect.ratio,\n\t\tapi.displays.length,\n\t\tapi.viewport || {width: 1, height: 1}\n\t), [api.aspect, api.displays, api.viewport])\n\n\treturn <>\n\t\t<main ref={viewport}\n\t\t\tonDrop={e => api.reorderDisplays(e.target)}>\n\t\t\t{api.displays.length === 0 && <Splash />}\n\t\t\t{api.displays.map((d, i) => <BDVideo size={size} objectFit={api.fit} key={d.id} display={d}\n\t\t\t\tshowOverlay={api.activeIndex === i}\n\t\t\t\tshowThumbnail={api.showThumbnails}\n\t\t\t\tonDrag={i => api.setPartialState({dragSrc: d})}\n\t\t\t\tonMouseOver={() => api.setPartialState({activeIndex: i})}\n\t\t\t\tonMouseOut={()=>api.setPartialState({activeIndex: undefined})}\n\t\t\t\tonLoad={() => d.triggerResize && api.setPartialState({aspect: getRecommendedAspect()})}\n\t\t\t\tonError={() => api.handleDisplayError()}\n\t\t\t\tremoveCallback={api.removeActive}\n\t\t\t\tcopyCallback={()=>api.copyDisplay(i)}\n\t\t\t\texclusiveCallback={() => api.setExclusive(i)}\n\t\t\t\tstaggerCallback={() => api.distributeTimes(i)}\n\t\t\t\tinCallback={() => api.setActiveIO(\"in\")}\n\t\t\t\toutCallback={() => api.setActiveIO(\"out\")}\n\t\t\t\tspeedCallback={adjustment => api.adjustActivePlaybackRate(adjustment)}\n\t\t\t/>)}\n\t\t</main>\n\t\t{api.errorDisplays.length > 0 && <ErrorDisplay errorDisplays={api.errorDisplays} dismissCallback={api.dismissErrors} />}\n\t\t{api.showHelp && <Help\n\t\t\taspectRatio={api.aspect}\n\t\t\tobjectFit={api.fit}\n\t\t\taspectRatioCallback={i=>api.setPartialState({aspect: i})}\n\t\t\tobjectFitCallback={i=>api.setPartialState({fit: i})} />}\n\t</>\n}\n\nexport default App","export function getVideoSize(aspectRatio:number, objects:number, constraints:{width:number,height:number}) {\r\n\t// try every number of rows up to a dedicated row for each video\r\n\tlet bestArea = 0, width = 0, height = 0\r\n\tfor (let rows = 1; rows <= objects; rows++) {\r\n\t\t// get the necessary number of columns with a given number of rows\r\n\t\tconst cols = Math.ceil(objects / rows)\r\n\t\t// this determines the size of the resulting box\r\n\t\tconst x = Math.floor(constraints.width / cols)\r\n\t\tconst y = Math.floor(constraints.height / rows)\r\n\t\t// actual video dimensions will depend on ratio within the display box, being shrunk on one side\r\n\t\tlet vx = x, vy = y\r\n\t\tif (aspectRatio > x/y) {\r\n\t\t\tvy = vx / aspectRatio\r\n\t\t} else {\r\n\t\t\tvx = vy * aspectRatio\r\n\t\t}\r\n\t\tconst videoArea = vx * vy\r\n\t\t// if this isn't an improvement, continue looking\r\n\t\tif (videoArea < bestArea) continue\r\n\t\t// otherwise save this as best situation\r\n\t\tbestArea = videoArea\r\n\t\twidth = x\r\n\t\theight = y\r\n\t}\r\n\r\n\treturn {width, height}\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === '[::1]' ||\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\n\t\twindow.location.hostname.match(\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n\t\t)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error('Error during service worker registration:', error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl)\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get('content-type');\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null && contentType.indexOf('javascript') === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log(\n\t\t\t\t'No internet connection found. App is running in offline mode.'\n\t\t\t);\n\t\t});\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\tregistration.unregister();\n\t\t});\n\t}\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister()\nserviceWorker.register()\n"],"sourceRoot":""}