{"version":3,"sources":["reducers/Settings.ts","reducers/Displays.ts","reducers/RootReducer.ts","FullScreen.ts","browser.ts","Thumbnail.tsx","components/IOMarker.tsx","IOBar.tsx","BDVideo.tsx","components/Help.tsx","components/ErrorDisplay.tsx","components/Splash.tsx","App.tsx","getVideoSize.ts","serviceWorker.js","index.tsx"],"names":["objectFits","getNext","list","current","indexOf","length","initialState","fit","aspect","aspectRatios","playbackRate","showThumbnails","muted","triggers","Settings","createSlice","name","reducers","nextAspect","state","nextFit","setAspect","_ref","payload","setFit","_ref2","setPlaybackRate","_ref3","toggleThumbnails","toggleMute","setTriggers","_ref4","Object","objectSpread2","clearTrigger","_ref5","undefined","setIn","_ref6","setOut","_ref7","actions","reducer","Displays","excludeOthers","excludeDifferent","url","filter","i","remove","concat","toConsumableArray","slice","copy","settings","id","uuid","add","_ref5$payload","file","title","type","URL","createObjectURL","reorder","_ref6$payload","si","src","di","dest","d","update","_ref7$payload","index","updateSettings","_ref8","_ref8$payload","rootReducer","combineReducers","displays","store","configureStore","dispatch","useSelector","useReduxSelector","fullscreenElement","element","requestFullscreen","msRequestFullscreen","webkitRequestFullscreen","call","fsEnabled","document","fullscreenEnabled","msFullscreenEnabled","webkitFullscreenEnabled","fsExit","exitFullscreen","msExitFullscreen","webkitExitFullscreen","bind","browser","navigator","userAgent","msBrowser","margins","edge","left","right","bottom","chrome","Thumbnail","offset","timestamp","_ref$width","width","video","React","useRef","currentTime","react_default","a","createElement","className","ref","controls","autoPlay","loop","style","diameter","IOMarker","color","height","viewBox","cx","cy","r","fill","IOBar","inTime","outTime","duration","ip","op","timelineWidth","ix","ox","Fragment","thumbnailMargin","BDVideo","forwardRef","props","showThumbnail","display","size","objectFit","handles","buttons","load","dragStart","error","mouseOver","mouseOut","buttonPress","_React$useState","useState","_React$useState2","slicedToArray","overlayTimeout","setOverlayTimeout","_React$useState3","_React$useState4","thumbnailState","setThumbnailState","useEffect","adjustDisplayTime","adjustment","percentage","arguments","v","shiftDisplayActions","arrowleft","arrowright","f","displayActions","m","onMouseOver","onMouseMove","e","clearTimeout","setTimeout","nativeEvent","layerX","layerY","videoPercentage","targetTime","onMouseOut","onKeyDown","ev","shiftKey","key","toLowerCase","pointerEvents","toFixed","map","label","action","onClick","IOBar_IOBar","Thumbnail_Thumbnail","assign","onError","onLoadedData","onLoadedMetadata","onTimeUpdate","onDragStart","target","offsetY","preventDefault","draggable","ToggleButton","value","callback","onText","offText","SHORTCUTS","desc","DISCLAIMER","SelectInput","choices","htmlFor","onChange","Help","_useSelector","toUpperCase","substr","AspectRatios","toString","parseInt","Help_ToggleButton","ErrorDisplay","errors","onClose","onSubmit","Splash","stopEvent","stopPropagation","addEventListener","getVideoTimeOffset","App","getRef","videos","setVideos","useCallback","createRef","defineProperty","useRefArray","_React$useReducer","useReducer","displayReducer","_React$useReducer2","dispatchDisplays","_useSelector$triggers","distributeTimes","active","setActive","_React$useState5","_React$useState6","setErrors","_React$useState7","_React$useState8","help","setHelp","_React$useState9","_React$useState10","dragSrc","setDragSrc","container","_React$useState11","_React$useState12","viewport","setViewport","anyDispatcher","startsWith","matchingDisplays","orderedDisplays","t1","startTime","spacing","forEach","updateTime","property","globalActions","useMemo","body","msFullscreenElement","webkitFullscreenElement","toggleFullscreen","h","s","t","x","handleResize","clientWidth","clientHeight","window","handleKeyDown","ctrlKey","ctrlDisplayActions","delete","c","o","copyActive","Array","removeEventListener","handleFileDrop","dataTransfer","from","files","aspectRatio","objects","constraints","bestArea","rows","cols","Math","ceil","floor","y","vx","vy","videoArea","getVideoSize","ratio","onDrop","findIndex","BDVideo_BDVideo","arr","avgRatio","videoWidth","videoHeight","reduce","b","sort","abs","pop","getRecommendedAspect","ErrorDisplay_ErrorDisplay","src_components_Help","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","ReactDOM","render","es","src_App_0","getElementById","process","href","origin","fetch","response","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.6ab9448f.chunk.js","sourcesContent":["import {createSlice, PayloadAction} from '@reduxjs/toolkit'\r\nimport {ObjectFitProperty} from 'csstype'\r\nimport aspectRatios from '../AspectRatios.json'\r\n\r\nexport const objectFits:ObjectFitProperty[] = ['contain', 'cover', 'fill', 'scale-down']\r\nexport type AspectRatio = typeof aspectRatios[number]\r\n\r\nexport type Setting<T> = {\r\n\treadonly current:T\r\n}\r\n\r\nconst getNext = <T,>(list:T[], current:T) =>\r\n\tlist[(list.indexOf(current) + 1) % list.length]\r\n\r\nexport type Settings = {\r\n\tfit:ObjectFitProperty\r\n\taspect:AspectRatio\r\n\tplaybackRate:Setting<number>\r\n\tshowThumbnails:Setting<boolean>\r\n\tmuted:Setting<boolean>\r\n\ttriggers: {\r\n\t\tdistributeTimes?:number\r\n\t\tsetIn?:number\r\n\t\tsetOut?:number\r\n\t}\r\n}\r\n\r\nexport type Trigger = Partial<Settings['triggers']>\r\n\r\nconst initialState:Settings = {\r\n\tfit: objectFits[0],\r\n\taspect: aspectRatios[0],\r\n\tplaybackRate:{current: 1},\r\n\tshowThumbnails:{current: true},\r\n\tmuted:{current: true},\r\n\ttriggers:{}\r\n}\r\nexport const Settings = createSlice({\r\n\tname: 'settings',\r\n\tinitialState,\r\n\treducers: {\r\n\t\tnextAspect: (state) => {state.aspect = getNext(aspectRatios, state.aspect)},\r\n\t\tnextFit: (state) => {state.fit = getNext(objectFits, state.fit)},\r\n\t\tsetAspect: (state, {payload}) => {state.aspect = payload},\r\n\t\tsetFit: (state, {payload}:PayloadAction<ObjectFitProperty>) => {state.fit = payload},\r\n\t\tsetPlaybackRate: (state, {payload}:PayloadAction<number>) => {state.playbackRate.current = payload},\r\n\t\t// does this update propertly thanks to immer or not?  Test!\r\n\t\ttoggleThumbnails: (state) => {state.showThumbnails.current = !state.showThumbnails.current},\r\n\t\ttoggleMute: (state) => {state.muted.current = !state.muted.current},\r\n\t\t// distributeTimes: (state, {payload}:PayloadAction<number>) => {state.triggers.distributeTimes = payload},\r\n\t\t// clearDistributeFlag: (state) => {state.triggers.distributeTimes = undefined},\r\n\t\tsetTriggers: (state, {payload}:PayloadAction<Trigger>) => {state.triggers = {...state.triggers, ...payload}},\r\n\t\tclearTrigger: (state, {payload}:PayloadAction<keyof Settings['triggers']>) => {state.triggers[payload] = undefined},\r\n\t\tsetIn: (state, {payload}:PayloadAction<number>) => {state.triggers.setIn = payload},\r\n\t\tsetOut: (state, {payload}:PayloadAction<number>) => {state.triggers.setOut = payload}\r\n\t}\r\n})\r\n\r\nexport const {actions, reducer} = Settings\r\n","import uuid from 'uuid'\r\nimport {createSlice, PayloadAction} from '@reduxjs/toolkit'\r\nimport {Setting} from './Settings'\r\n\r\nexport type Display = {\r\n\tid:string\r\n\ttitle:string\r\n\ttype:string\r\n\turl:string\r\n\tinTime?:number\r\n\toutTime?:number\r\n\tsettings:{\r\n\t\tmuted:Setting<boolean>\r\n\t\tcurrentTime?:Setting<number>\r\n\t\t// playbackRate:Setting<number>\r\n\t\tplaybackRate:number\r\n\t}\r\n\t// video?:HTMLVideoElement\r\n\t// triggerResize:boolean\r\n}\r\n\r\ntype AddPayload = {\r\n\tfile:File\r\n\tsettings:Display['settings']\r\n}\r\nexport const Displays = createSlice({\r\n\tname: 'Displays',\r\n\tinitialState: [] as Display[],\r\n\treducers: {\r\n\t\texcludeOthers: (state, {payload}:PayloadAction<number>) => [state[payload]],\r\n\t\texcludeDifferent: (state, {payload}:PayloadAction<number>) => {\r\n\t\t\tconst {url} = state[payload]\r\n\t\t\treturn state.filter(i => i.url === url)\r\n\t\t},\r\n\t\tremove: (state, {payload}:PayloadAction<number>) =>\r\n\t\t\t[...state.slice(0, payload), ...state.slice(payload+1)],\r\n\t\tcopy: (state, {payload}:PayloadAction<number>) =>\r\n\t\t\t[...state, {...state[payload], settings: {...state[payload].settings}, id: uuid()}],\r\n\t\t// should use muted, playbackspeed from global settings for default\r\n\t\tadd: (state, {payload:{file, settings}}:PayloadAction<AddPayload>) =>\r\n\t\t\t[...state, {\r\n\t\t\t\tid: uuid(),\r\n\t\t\t\ttitle: file.name,\r\n\t\t\t\ttype: file.type,\r\n\t\t\t\turl: URL.createObjectURL(file),\r\n\t\t\t\tsettings\r\n\t\t\t}],\r\n\t\treorder: (state, {payload: {src: si, dest: di}}:PayloadAction<{src:number,dest:number}>) => {\r\n\t\t\tconst d = state\r\n\t\t\treturn (si > di ? [\r\n\t\t\t\t...d.slice(0, di),\r\n\t\t\t\td[si],\r\n\t\t\t\t...d.slice(di, si),\r\n\t\t\t\t...d.slice(si+1)\r\n\t\t\t] : [\r\n\t\t\t\t...d.slice(0, si),\r\n\t\t\t\t...d.slice(si+1, di+1),\r\n\t\t\t\td[si],\r\n\t\t\t\t...d.slice(di+1)\r\n\t\t\t])\r\n\t\t},\r\n\t\tupdate: (state, {payload: {index, settings}}:PayloadAction<{index:number, settings:Partial<Display>}>) => {\r\n\t\t\tconst i = state[index]\r\n\t\t\treturn [...state.slice(0, index), {...i, ...settings}, ...state.slice(index+1)]\r\n\t\t},\r\n\t\tupdateSettings: (state, {payload: {index, settings}}:PayloadAction<{index:number, settings:Partial<Display['settings']>}>) => {\r\n\t\t\tconst i = state[index]\r\n\t\t\ti.settings = {...i.settings, ...settings}\r\n\t\t\t// return [...state.slice(0, index), {...i, settings: {...i.settings, ...settings}, ...state.slice(index+1)}]\r\n\t\t},\r\n\r\n\t\t// updateAll: (state, {payload}:PayloadAction<Modifier<Display>>) => {\r\n\t\t// \tstate.displays = state.displays.map(payload)\r\n\t\t// },\r\n\t\t// updateOne: (state, {payload}:PayloadAction<Partial<Display>>) => {\r\n\t\t// \tconst {displays: d, active: a} = state\r\n\t\t// \tstate.displays = [...d.slice(0, a), {...d[a], ...payload}, ...d.slice(a+1)]\r\n\t\t// },\r\n\t}\r\n})\r\n\r\nexport const {actions, reducer} = Displays\r\n","import {combineReducers} from 'redux'\r\nimport {useSelector as useReduxSelector, TypedUseSelectorHook} from 'react-redux'\r\nimport {configureStore} from '@reduxjs/toolkit'\r\nimport {Settings} from './Settings'\r\nimport {Displays} from './Displays'\r\n\r\nconst rootReducer = combineReducers({\r\n\tsettings: Settings.reducer,\r\n\tdisplays: Displays.reducer,\r\n})\r\n\r\nexport type RootState = ReturnType<typeof rootReducer>\r\n\r\nexport const store = configureStore({\r\n\treducer: rootReducer\r\n})\r\n\r\nexport const {dispatch} = store\r\n\r\nexport const useSelector:TypedUseSelectorHook<RootState> = useReduxSelector","export const fullscreenElement = (element:HTMLElement) => {\r\n\t(\r\n\t\telement.requestFullscreen ||\r\n\t\t(element as any).msRequestFullscreen ||\r\n\t\t(element as any).webkitRequestFullscreen\r\n\t).call(element)\r\n}\r\n\r\nconst fsEnabled = document.fullscreenEnabled || (document as any).msFullscreenEnabled || (document as any).webkitFullscreenEnabled\r\nconst fsExit = (document.exitFullscreen || (document as any).msExitFullscreen || (document as any).webkitExitFullscreen).bind(document)\r\nexport const toggleFullscreen = (target:HTMLElement = document.body) => {\r\n\tif (!fsEnabled) return\r\n\tconst fsElement = document.fullscreenElement || (document as any).msFullscreenElement || (document as any).webkitFullscreenElement\r\n\tif (fsElement) {\r\n\t\tfsExit()\r\n\t} else {\r\n\t\tfullscreenElement(target)\r\n\t}\r\n}\r\n","function getBrowser() {\r\n\tif (navigator.userAgent.indexOf(' Trident/') > -1) return 'IE'\r\n\tif (navigator.userAgent.indexOf(' Edge/') > -1) return 'Edge'\r\n\treturn 'Chrome'\r\n}\r\n\r\nconst videoMargins = {\r\n\t\"edge\": {\r\n\t\t\"left\": 116,\r\n\t\t\"right\": 220,\r\n\t\t\"bottom\": 24\r\n\t},\r\n\t\"chrome\": {\r\n\t\t\"left\": 24,\r\n\t\t\"right\": 24,\r\n\t\t\"bottom\": 16\r\n\t}\r\n}\r\n\r\n\r\nexport const browser = getBrowser()\r\nexport const msBrowser = [\"Edge\",\"IE\"].indexOf(browser) > -1\r\nexport const margins = videoMargins[browser === \"Chrome\" ? 'chrome' : 'edge']","import React from 'react'\r\nconst thumbnailWidth = 196\r\n\r\ntype ThumbnailProps = {\r\n\tsrc:string\r\n\toffset:number\r\n\ttimestamp:number\r\n\twidth?:number\r\n}\r\n\r\nexport const Thumbnail = ({src, offset, timestamp, width=thumbnailWidth}:ThumbnailProps) => {\r\n\tconst video = React.useRef<HTMLVideoElement>(null)\r\n\tif (video.current) video.current.currentTime = timestamp\r\n\r\n\treturn <video className=\"thumbnail\"\r\n\t\tref={video}\r\n\t\tcontrols={false} autoPlay={false} loop={false} muted={true}\r\n\t\tsrc={src} width={width} style={{left: offset - (width / 2)}} />\r\n}\r\n","import React from 'react'\r\nimport { margins } from '../browser'\r\n\r\ntype IOMarkerProps = {\r\n\toffset:number\r\n\tcolor:string\r\n}\r\n\r\nconst diameter = 10\r\nexport function IOMarker({offset, color}:IOMarkerProps) {\r\n\tconst style = {\r\n\t\tbottom: margins.bottom + (diameter/2),\r\n\t\tleft: margins.left + offset - (diameter/2)\r\n\t}\r\n\treturn <svg className=\"iomarker\"\r\n\t\twidth={diameter} height={diameter}\r\n\t\tviewBox={`0 0 2 2`} style={style}>\r\n\t\t<circle cx={1} cy={1} r={1} fill={color} />\r\n\t</svg>\r\n}","import React from 'react'\r\nimport { IOMarker } from './components/IOMarker'\r\nimport { margins } from './browser'\r\n\r\ntype IOBarProps = {\r\n\tinTime?:number\r\n\toutTime?:number\r\n\tvideo:HTMLVideoElement\r\n}\r\n\r\nexport const IOBar = ({inTime, outTime, video}:IOBarProps) => {\r\n\tif (!(inTime || outTime)) return null\r\n\tconst duration = video.duration\r\n\tconst ip = inTime || 0\r\n\tconst op = outTime || duration\r\n\tconst timelineWidth = video.width - margins.left - margins.right\r\n\tconst ix = (ip / duration) * timelineWidth\r\n\tconst ox = (op / duration) * timelineWidth\r\n\treturn <>\r\n\t\t<IOMarker offset={ix} color=\"gold\" />\r\n\t\t<IOMarker offset={ox} color=\"gold\" />\r\n\t</>\r\n}","import React, { Dispatch } from 'react'\r\nimport { ObjectFitProperty } from 'csstype'\r\n\r\nimport { fullscreenElement } from './FullScreen'\r\nimport { margins, browser, msBrowser } from './browser'\r\nimport { Thumbnail } from './Thumbnail'\r\nimport { IOBar } from './IOBar'\r\nimport { Viewport } from './App'\r\nimport './BDVideo.css'\r\nimport { AnyAction } from 'redux'\r\nimport { Display } from './reducers/Displays'\r\n\r\ntype BDVideoProps = {\r\n\tdisplay:Display\r\n\tsize:Viewport\r\n\tobjectFit:ObjectFitProperty\r\n\tshowThumbnail:boolean\r\n\thandles: {\r\n\t\tload:()=>void\r\n\t\tdragStart:()=>void\r\n\t\terror:()=>void\r\n\t\tmouseOver:()=>void\r\n\t\tmouseOut:()=>void\r\n\t\tbuttonPress:Dispatch<AnyAction>\r\n\t},\r\n\tbuttons: {\r\n\t\tlabel:string\r\n\t\taction:AnyAction\r\n\t}[]\r\n}\r\n\r\nconst tryActions = (actions:{[key:string]:()=>void}, key:string) =>\r\n\tkey in actions && actions[key]()\r\n\r\ntype ThumbnailState = {\r\n\toffset:number // x-axis mouse position\r\n\ttimestamp:number\r\n}\r\n\r\nconst dragMargin = 80\r\nconst thumbnailMargin = margins.bottom + 8\r\n\r\nconst overlayDuration = 4000\r\nexport const BDVideo = React.forwardRef((props:BDVideoProps, forwardRef:React.Ref<HTMLVideoElement>) => {\r\n\tconst video = React.useRef<HTMLVideoElement>(null)\r\n\r\n\tconst {showThumbnail, display, size, objectFit, handles, buttons} = props\r\n\tconst {title, url, settings, outTime, inTime} = display\r\n\tconst {load, dragStart, error, mouseOver, mouseOut, buttonPress} = handles\r\n\r\n\tconst [overlayTimeout, setOverlayTimeout] = React.useState<NodeJS.Timeout>()\r\n\tconst [thumbnailState, setThumbnailState] = React.useState<ThumbnailState>()\r\n\r\n\tconst handleMouseOut = () => {\r\n\t\tsetThumbnailState(undefined)\r\n\t\tmouseOut()\r\n\t}\r\n\tconst handleMouseMove = (e:React.MouseEvent) => {\r\n\t\toverlayTimeout && clearTimeout(overlayTimeout)\r\n\t\tsetOverlayTimeout(setTimeout(()=>setOverlayTimeout(undefined), overlayDuration))\r\n\r\n\t\tconst v = video.current!\r\n\r\n\t\tif (!showThumbnail || browser === 'IE') return\r\n\t\tconst {layerX, layerY} = e.nativeEvent as any\r\n\t\tconst distanceFromBottom = v.height - layerY\r\n\t\tif (distanceFromBottom > thumbnailMargin) {\r\n\t\t\treturn setThumbnailState(undefined)\r\n\t\t}\r\n\t\tconst timelineWidth = v.width - margins.left - margins.right\r\n\t\tconst videoPercentage = (layerX - margins.left) / timelineWidth \r\n\t\tif (videoPercentage < 0 || videoPercentage > 1) {\r\n\t\t\treturn setThumbnailState(undefined)\r\n\t\t}\r\n\t\tconst targetTime = v.duration * videoPercentage\r\n\t\tsetThumbnailState({\r\n\t\t\toffset: layerX,\r\n\t\t\ttimestamp: targetTime\r\n\t\t})\r\n\t}\r\n\r\n\tconst handleDragStart = (e:React.DragEvent<HTMLVideoElement>) => {\r\n\t\tconst target = e.target! as HTMLVideoElement\r\n\t\tconst distanceFromBottom = target.height - (e as any).offsetY\r\n\t\tif (distanceFromBottom < dragMargin) e.preventDefault()\r\n\t\telse dragStart()\r\n\t}\r\n\r\n\tReact.useEffect(() => {\r\n\t\tvideo.current!.muted = settings.muted.current\r\n\t}, [settings.muted])\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (settings.currentTime) {\r\n\t\t\tvideo.current!.currentTime = settings.currentTime.current\r\n\t\t}\r\n\t}, [settings.currentTime])\r\n\r\n\tReact.useEffect(() => {\r\n\t\tvideo.current!.playbackRate = settings.playbackRate\r\n\t}, [settings.playbackRate])\r\n\r\n\tconst handleLoad = () => {\r\n\t\tconst v = video.current!\r\n\t\tif (v.currentTime < 1) v.currentTime = v.duration / 2\r\n\t}\r\n\r\n\tconst handleTimeUpdate = () => {\r\n\t\tconst v = video.current!\r\n\t\tconst pastOut = outTime && outTime < v.currentTime\r\n\t\t// const beforeIn = inTime && inTime > v.currentTime\r\n\t\t// if (pastOut || beforeIn) v.currentTime = inTime || 0\r\n\t\tif (pastOut) v.currentTime = inTime || 0\r\n\t}\r\n\r\n\tconst adjustDisplayTime = (adjustment:number, percentage:boolean = false) => {\r\n\t\tconst v = video.current!\r\n\t\tif (percentage) adjustment = v.duration * adjustment\r\n\t\tv.currentTime = (v.currentTime + adjustment + v.duration) % v.duration\r\n\t}\r\n\r\n\t// memoize some of these, or entire groups?\r\n\tconst shiftDisplayActions = {\r\n\t\t\"arrowleft\": () => adjustDisplayTime(-.1, true),\r\n\t\t\"arrowright\": () => adjustDisplayTime(.1, true),\r\n\t\t\"f\": () => fullscreenElement(video.current!)\r\n\t}\r\n\tconst displayActions = {\r\n\t\t\"m\": () => { video.current!.muted = !video.current!.muted },\r\n\t\t\"arrowleft\": () => adjustDisplayTime(-60),\r\n\t\t\"arrowright\": () => adjustDisplayTime(60),\r\n\t}\r\n\r\n\tconst handleDisplayKeyDown = (ev:React.KeyboardEvent<HTMLDivElement>) =>\r\n\t\ttryActions(\r\n\t\t\tev.shiftKey ? shiftDisplayActions : displayActions,\r\n\t\t\tev.key.toLowerCase()\r\n\t\t)\r\n\r\n\treturn <div className=\"display\"\r\n\t\tonMouseOver={mouseOver}\r\n\t\tonMouseMove={handleMouseMove}\r\n\t\tonMouseOut={handleMouseOut}\r\n\t\tonKeyDown={handleDisplayKeyDown}>\r\n\t\t{video.current && overlayTimeout && <>\r\n\t\t\t<div className=\"display-border\" style={{pointerEvents: msBrowser ? 'none' : 'auto'}}>\r\n\t\t\t\t{/* playbackRate is not updating live - why not?  Have to move mouse which updates event handler in order to redraw\r\n\t\t\t\tis it possible I'm updating old Display object instead of setting a new one, and so props doesn't change? */}\r\n\t\t\t\t{title}{video.current.playbackRate !== 1 ? ` (${video.current.playbackRate.toFixed(2)}x)` : ''}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"display-controls\">\r\n\t\t\t\t{buttons.map(({label, action}) => <button key={label} onClick={()=>buttonPress(action)}>{label}</button>)}\r\n\t\t\t</div>\r\n\t\t\t<IOBar\r\n\t\t\t\tinTime={inTime}\r\n\t\t\t\toutTime={outTime}\r\n\t\t\t\tvideo={video.current}\r\n\t\t\t/>\r\n\t\t</>}\r\n\t\t{showThumbnail && thumbnailState && <Thumbnail src={url} {...thumbnailState} />}\r\n\t\t<video\r\n\t\t\tref={ref => {\r\n\t\t\t\t(video as {current:HTMLVideoElement|null}).current = ref\r\n\t\t\t\tif (typeof forwardRef === 'function') {\r\n\t\t\t\t\tforwardRef(ref)\r\n\t\t\t\t} else if (forwardRef !== null) {\r\n\t\t\t\t\t(forwardRef as {current:HTMLVideoElement|null}).current = ref\r\n\t\t\t\t}\r\n\t\t\t}}\r\n\t\t\tcontrols autoPlay loop muted\r\n\t\t\tonError={error}\r\n\t\t\tonLoadedData={handleLoad}\r\n\t\t\tonLoadedMetadata={load}\r\n\t\t\tonTimeUpdate={outTime || inTime ? handleTimeUpdate : undefined}\r\n\t\t\tonDragStart={handleDragStart}\r\n\t\t\tsrc={url}\r\n\t\t\tdraggable={!msBrowser}\r\n\t\t\t{...size}\r\n\t\t\tstyle={{objectFit}}\r\n\t\t/>\r\n\t</div>\r\n})\r\n","import { ObjectFitProperty } from \"csstype\"\r\n\r\nimport React from 'react'\r\n\r\nimport {actions as Settings} from '../reducers/Settings'\r\nimport {objectFits} from '../reducers/Settings'\r\nimport AspectRatios from '../AspectRatios.json'\r\nimport { useSelector, dispatch } from '../reducers/RootReducer'\r\nimport './Help.css'\r\n\r\nconst shortCuts = [\r\n\t['C',\"Clone video (+1m)\"],\r\n\t['D',\"Distribute times\"],\r\n\t['E',\"Remove everything else\"],\r\n\t['F',\"Toggle fullscreen\"],\r\n\t['Shift+F',\"Fullscreen video\"],\r\n\t['H',\"Toggle help\"],\r\n\t['I',\"Toggle in point\"],\r\n\t['O',\"Toggle out point\"],\r\n\t['M',\"Toggle mute\"],\r\n\t['R',\"Remove video\"],\r\n\t['S',\"Change video scaling\"],\r\n\t['X',\"Change aspect ratio\"],\r\n\t['← →',\"Skip 1m\"],\r\n\t['Shift ← →',\"Skip 10%\"],\r\n\t['Ctrl ← →',\"Change speed\"],\r\n\t['Ctrl+W',\"Close tab\"],\r\n\t['O,O',\"Restart video\"],\r\n\t['1-9',\"Fill 2-9 size grid\"],\r\n\t['Drag+Drop',\"Reorder videos\"],\r\n]\r\n\r\ntype ToggleButtonProps = {\r\n\tvalue:boolean\r\n\tcallback:()=>void\r\n\tonText:string\r\n\toffText:string\r\n}\r\nconst ToggleButton = ({value, callback, onText, offText}:ToggleButtonProps) => {\r\n\treturn <button onClick={e=>{\r\n\t\te.preventDefault()\r\n\t\tcallback()\r\n\t}}>{value ? onText : offText}</button>\r\n}\r\n\r\nconst SHORTCUTS = <section id=\"shortcuts\">\r\n\t<h2>Shortcuts</h2><ol>\r\n\t\t{shortCuts.map(([key, desc]) =>\r\n\t\t\t<li key={key}><em>{key}:</em> {desc}</li>)}\r\n\t</ol>\r\n</section>\r\n\r\nconst DISCLAIMER = <footer>\r\n\t<h2>Privacy Disclaimer</h2>\r\n\t<p>This tool records <b>no</b> filenames, screen grabs, or any other methods of identifying the actual contents of any video.  Only metadata about a video's format (codec, file size, resolution, and duration) may be recorded.</p>\r\n</footer>\r\n\r\nexport const Help = () => {\r\n\tconst {aspect, fit, playbackRate: {current: playbackRate}, showThumbnails: {current: showThumbnails}, muted: {current: muted}} = useSelector(state => state.settings)\r\n\treturn <section id=\"help\">\r\n\t\t<h2>Usage</h2>\r\n\t\t<p>Drag and drop any number of videos to auto-play in an optimally arranged grid.</p>\r\n\t\t<section id=\"settings\">\r\n\t\t\t<h2>Settings</h2>\r\n\t\t\t<form>\r\n\t\t\t\t<SelectInput\r\n\t\t\t\t\tname=\"objectScale\" label=\"Video Fit/Fill\"\r\n\t\t\t\t\tvalue={fit} choices={objectFits.map(v => <option key={v} value={v}>{v[0].toUpperCase()+v.substr(1)}</option>)}\r\n\t\t\t\t\tcallback={v=>dispatch(Settings.setFit(v as ObjectFitProperty))} /><br />\r\n\r\n\t\t\t\t<SelectInput\r\n\t\t\t\t\tname=\"aspectRatio\" label=\"Aspect Ratio\"\r\n\t\t\t\t\tvalue={AspectRatios.indexOf(aspect).toString()}\r\n\t\t\t\t\tchoices={AspectRatios.map((v, i) => <option key={i} value={i}>{v.name}</option>)}\r\n\t\t\t\t\tcallback={i=>dispatch(Settings.setAspect(AspectRatios[parseInt(i)]))} /><br />\r\n\r\n\t\t\t\t<div>Playback Rate: <button onClick={e=>{\r\n\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\tdispatch(Settings.setPlaybackRate(playbackRate / 2))\r\n\t\t\t\t}}>-</button>{playbackRate.toFixed(2)}<button onClick={e=>{\r\n\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\tdispatch(Settings.setPlaybackRate(playbackRate * 2))\r\n\t\t\t\t}}>+</button></div>\r\n\r\n\t\t\t\t{/* <button onClick={e=>{\r\n\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\tdispatch(Settings.toggleThumbnails())\r\n\t\t\t\t}} name=\"showThumbnails\">{showThumbnails ? 'Disable Thumbs' : 'Enable Thumbs'}</button> */}\r\n\t\t\t\t<ToggleButton\r\n\t\t\t\t\tvalue={showThumbnails}\r\n\t\t\t\t\tcallback={()=>dispatch(Settings.toggleThumbnails())}\r\n\t\t\t\t\tonText=\"Disable Thumbs\"\r\n\t\t\t\t\toffText=\"Enable Thumbs\" /><br />\r\n\r\n\t\t\t\t<ToggleButton\r\n\t\t\t\t\tvalue={muted}\r\n\t\t\t\t\tcallback={()=>dispatch(Settings.toggleMute())}\r\n\t\t\t\t\tonText=\"Unmute\"\r\n\t\t\t\t\toffText=\"Mute\" /><br />\r\n\t\t\t</form>\r\n\t\t</section>\r\n\t\t{SHORTCUTS}\r\n\t\t{DISCLAIMER}\r\n\t</section>\r\n}\r\n\r\ntype SelectInputType = {\r\n\tname:string\r\n\tlabel:string\r\n\tvalue:string\r\n\tchoices:JSX.Element[]\r\n\tcallback:(val:string)=>void\r\n}\r\nfunction SelectInput({name, label, value, choices, callback}:SelectInputType) {\r\n\treturn <>\r\n\t\t<label htmlFor={name}>{label}</label>\r\n\t\t<select name={name} value={value} onChange={e => callback(e.target.value)}>\r\n\t\t\t{choices}\r\n\t\t</select>\r\n\t</>\r\n}\r\n\r\n// type NumInputProps = {\r\n// \tvalue:number\r\n// \tname:string\r\n// \tlabel:string\r\n// \tcallback:(num:number)=>void\r\n// }\r\n// const NumInput = ({value,name,label,callback}:NumInputProps) => <>\r\n// \t<label htmlFor={name}>{label}</label>\r\n// \t<input type=\"number\" min={0} maxLength={3} name={name} value={value} onChange={e => callback(parseFloat(e.target.value))} />\r\n// </>\r\n\r\nexport default Help","import React from 'react'\r\nimport { Display } from '../reducers/Displays'\r\n\r\ntype ErrorDisplayProps = {\r\n\terrors:Display[]\r\n\tonClose:()=>void\r\n}\r\nexport const ErrorDisplay = ({errors, onClose}:ErrorDisplayProps) => {\r\n\r\n\treturn <section id=\"errors\">\r\n\t\t<h2>Errors</h2><ol>\r\n\t\t\t{errors.map(({id, title, type}) => <li key={id}>{title} ({type})</li>)}\r\n\t\t</ol>\r\n\t\t<p>Only videos supported by your web browser will play successfully.  <code>.mp4</code> and <code>.webm</code> files are good bets.</p>\r\n\t\t<form onSubmit={onClose}><button>Dismiss</button></form>\r\n\t</section>\r\n}\r\n","import React from 'react'\r\n\r\n// TODO: add logo\r\nexport function Splash() {\r\n\treturn <section id=\"splash\">\r\n\t\t<p>Auto-play any number of videos or copies of videos in an optimally arranged grid with simple drag-and-drop.  Videos start half-way in and loop, ensuring immediate, continuous immersion, great for scouring surveillance footage, finding the best highlights from your last gaming stream, and more!</p>\r\n\t\t<p>Find your favourite moments quickly with thumbnail scrubbing and keyboard shortcuts to jump ahead in time 1m (→) or 10% (Shift →), or adjust playback speed (Ctrl →).</p>\r\n\t\t<p>Use shortcut keys to rapidly (c)opy or (r)emove displays, set (i)n/(o)ut loop points, (f)ullscreen the display, toggle (m)ute, etc.</p>\r\n\t\t{/* <img src=\"clipart/surveillance.jpg\" alt=\"Surveillance\" />\r\n\t\t<img src=\"clipart/television.jpg\" alt=\"Television\" /> */}\r\n\t</section>\r\n}\r\n\r\n","// TODO: import only required polyfills\n// import 'react-app-polyfill/ie11'\n// import '@babel/polyfill'\n// import 'core-js/modules/es6.array.from'\n\n// TODO: refence react as third party library on cdn?\nimport React from 'react'\nimport { PayloadAction, AnyAction } from '@reduxjs/toolkit'\nimport {useSelector, dispatch} from './reducers/RootReducer'\nimport {actions as Settings, Settings as SettingsType} from './reducers/Settings'\nimport {Display, actions as Displays, reducer as displayReducer} from './reducers/Displays'\nimport { BDVideo } from './BDVideo'\nimport Help from './components/Help'\nimport { ErrorDisplay } from './components/ErrorDisplay'\nimport { Splash } from './components/Splash'\nimport aspectRatios from './AspectRatios.json'\nimport './App.css'\n\nimport {getVideoSize} from './getVideoSize'\n// import { AppReducer, objectFits, AppAction } from './AppReducer'\n// import { AppAction } from './AppReducer'\nimport { toggleFullscreen } from './FullScreen'\n\nconst avg = (arr:number[]) => arr.reduce((a, b) => a + b, 0) / arr.length\n\nconst stopEvent = (e:Event) => {\n\te.preventDefault()\n\te.stopPropagation()\n}\n\ndocument.addEventListener('dragover', stopEvent)\ndocument.addEventListener('dragenter', stopEvent)\ndocument.addEventListener('dragleave', stopEvent)\n\nconst getVideoTimeOffset = (video:HTMLVideoElement, percentage:number) =>\n\tvideo.currentTime + (video.duration * percentage)\n\ntype TransitionalActionSet = Record<string, (()=>void)|PayloadAction>\n\nexport type Viewport = {\n\twidth:number\n\theight:number\n}\n\nconst useRefArray = <T,>() => {\n\tconst [videos, setVideos] = React.useState<Record<string, React.RefObject<T>>>({})\n\n\treturn React.useCallback((id:string) => {\n\t\tif (id in videos) return videos[id]\n\t\tconst ref = React.createRef<T>()\n\t\tsetVideos({...videos, [id]: ref})\n\t\treturn ref\n\t}, [videos])\n}\n\nconst App = () => {\n\tconst getRef = useRefArray<HTMLVideoElement>()\n\tconst [displays, dispatchDisplays] = React.useReducer(displayReducer, [])\n\tconst {aspect, fit, showThumbnails, playbackRate, muted, triggers: {distributeTimes, setIn, setOut}} = useSelector(state => state.settings)\n\tconst [active, setActive] = React.useState<number|null>(null)\n\tconst [errors, setErrors] = React.useState<Display[]>([])\n\tconst [help, setHelp] = React.useState(true)\n\tconst [dragSrc, setDragSrc] = React.useState<Display>()\n\n\tconst container = React.useRef<HTMLElement>(null)\n\tconst [viewport, setViewport] = React.useState<Viewport>({width: 1, height: 1})\n\n\t// this feels like a hack!\n\tconst anyDispatcher = (action:AnyAction) => {\n\t\tconst dispatcher = action.type.startsWith('settings/') ? dispatch : dispatchDisplays\n\t\tdispatcher(action)\n\t}\n\n\tReact.useEffect(() => {\n\t\tconst i = distributeTimes\n\t\tif (i === undefined) return\n\t\tconst display = displays[i]\n\t\tconst {id, url} = display\n\t\tconst video = getRef(id).current\n\t\tif (!video) return\n\n\t\tconst matchingDisplays = displays.filter(i => i.url === url)\n\t\t// start with target display so it keeps its current time, bump up from there looping back to start\n\t\tconst orderedDisplays = [\n\t\t\tdisplay,\n\t\t\t...matchingDisplays.slice(i+1),\n\t\t\t...matchingDisplays.slice(0, i)\n\t\t]\n\n\t\tconst t1 = video.currentTime\n\t\tconst startTime = display.inTime || 0\n\t\tconst duration = (display.outTime || video.duration) - startTime\n\t\tconst spacing = duration / orderedDisplays.length\n\n\t\torderedDisplays.forEach((v, i) => {\n\t\t\tconst targetTime = t1 + (spacing * i)\n\t\t\t// loop time back to beginning once we exceed end of video\n\t\t\tgetRef(v.id).current!.currentTime = targetTime % duration + startTime\n\t\t})\n\t\tdispatch(Settings.clearTrigger('distributeTimes'))\n\t\t// eslint-disable-next-line\n\t}, [distributeTimes])\n\n\tconst updateTime = (index:number|undefined, property:keyof Display, name:keyof SettingsType['triggers']) => {\n\t\tif (index === undefined) return\n\t\tconst display = displays[index]\n\t\tconst currentTime = display[property] === undefined ? getRef(display.id).current!.currentTime : undefined\n\t\tdispatchDisplays(Displays.update({\n\t\t\tindex,\n\t\t\tsettings: {[property]: currentTime}\n\t\t}))\n\t\tdispatch(Settings.clearTrigger(name))\n\t\t// eslint-disable-next-line\n\n\t}\n\tReact.useEffect(() => {\n\t\tupdateTime(setIn, 'inTime', 'setIn')\n\t\t// eslint-disable-next-line\n\t}, [setIn])\n\n\tReact.useEffect(() => {\n\t\tupdateTime(setOut, 'outTime', 'setOut')\n\t\t// eslint-disable-next-line\n\t}, [setOut])\n\n\tconst globalActions:TransitionalActionSet = React.useMemo(() => ({\n\t\t\"f\": ()=>toggleFullscreen(),\n\t\t\"h\": ()=>setHelp(!help),\n\t\t\"s\": Settings.nextFit(),\n\t\t\"t\": Settings.toggleThumbnails(),\n\t\t\"x\": Settings.nextAspect()\n\t}), [help])\n\n\tReact.useEffect(() => {\n\t\tconst handleResize = () => {\n\t\t\tconst i = container.current!\n\t\t\tsetViewport({width: i.clientWidth, height: i.clientHeight})\n\t\t}\n\t\twindow.addEventListener('resize', handleResize)\n\t\thandleResize()\n\t}, [])\n\n\tReact.useEffect(() => {\n\t\tdisplays.forEach((d, i) => dispatchDisplays(Displays.updateSettings({index: i, settings: {playbackRate: playbackRate.current}})))\n\t\t// I don't want to run this when getRef or displays runs!  eslint tells me I should\n\t\t// eslint-disable-next-line\n\t}, [playbackRate])\n\n\tReact.useEffect(() => {\n\t\tdisplays.forEach((d, i) => dispatchDisplays(Displays.updateSettings({index: i, settings: {muted}})))\n\t\t// I don't want to run this when getRef or displays runs!  eslint tells me I should\n\t\t// eslint-disable-next-line\n\t}, [muted])\n\n\tReact.useEffect(() => {\n\t\tconst handleKeyDown = (ev:KeyboardEvent) => {\n\t\t\tconst key = ev.key.toLowerCase()\n\t\t\tif (key in globalActions && !ev.shiftKey && !ev.ctrlKey) {\n\t\t\t\tconst action = globalActions[key]\n\t\t\t\tif (typeof action === 'function') {\n\t\t\t\t\treturn action()\n\t\t\t\t}\n\t\t\t\treturn dispatch(action)\n\t\t\t}\n\n\t\t\tconst index = active\n\t\t\tif (index === null) return\n\t\t\tconst ctrlDisplayActions = {\n\t\t\t\t'arrowleft': Displays.updateSettings({index, settings: {playbackRate: displays[index].settings.playbackRate / 2}}),\n\t\t\t\t'arrowright': Displays.updateSettings({index, settings: {playbackRate: displays[index].settings.playbackRate * 2}}),\n\t\t\t}\n\t\t\tconst shiftDisplayActions = {\n\t\t\t\t'arrowleft': Displays.updateSettings({index, settings: {currentTime: {current: getVideoTimeOffset(getRef(displays[index].id).current!, -.1)}}}),\n\t\t\t\t'arrowright': Displays.updateSettings({index, settings: {currentTime: {current: getVideoTimeOffset(getRef(displays[index].id).current!, .1)}}}),\n\t\t\t}\n\n\t\t\tconst displayActions = {\n\t\t\t\t\"delete\": Displays.remove(index),\n\t\t\t\t\"r\": Displays.remove(index),\n\t\t\t\t\"c\": Displays.copy(index),\n\t\t\t\t\"d\": Settings.setTriggers({distributeTimes: index}),\n\t\t\t\t\"e\": Displays.excludeOthers(index),\n\t\t\t\t\"i\": Settings.setIn(index),\n\t\t\t\t\"o\": Settings.setOut(index),\n\t\t\t}\n\n\t\t\tif (ev.shiftKey) {\n\t\t\t\tkey in shiftDisplayActions && dispatchDisplays(shiftDisplayActions[key as keyof typeof shiftDisplayActions])\n\t\t\t} else if (ev.ctrlKey) {\n\t\t\t\tkey in ctrlDisplayActions && dispatchDisplays(ctrlDisplayActions[key as keyof typeof ctrlDisplayActions])\n\t\t\t} else {\n\t\t\t\tif (key in displayActions) {\n\t\t\t\t\tconst action = displayActions[key as keyof typeof displayActions]\n\t\t\t\t\tconst dispatcher = action.type.startsWith(\"settings/\") ? dispatch : dispatchDisplays\n\t\t\t\t\tdispatcher(action)\n\t\t\t\t} else if (key >= \"1\" && key <= \"9\") {\n\t\t\t\t\tconst copyActive = Displays.copy(index)\n\t\t\t\t\tArray(parseInt(key)).fill(null).forEach(()=>dispatchDisplays(copyActive))\n\t\t\t\t\tdispatch(Settings.setTriggers({distributeTimes: index}))\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twindow.addEventListener('keydown', handleKeyDown)\n\t\treturn () => window.removeEventListener('keydown', handleKeyDown)\n\t}, [displays, active, globalActions, getRef])\n\n\tReact.useEffect(() => {\n\t\tconst handleFileDrop = (e:DragEvent) => {\n\t\t\tstopEvent(e)\n\t\t\tif (!e.dataTransfer) return\n\t\t\tconst droppedFiles = Array.from(e.dataTransfer.files)\n\t\t\tdroppedFiles.map(file => dispatchDisplays(Displays.add({file, settings: {muted, playbackRate: playbackRate.current}})))\n\t\t\tsetHelp(false)\n\t\t}\n\t\tdocument.addEventListener('drop', handleFileDrop)\n\t\treturn () => document.removeEventListener('drop', handleFileDrop)\n\t}, [muted, playbackRate])\n\n\tconst getRecommendedAspect = () => {\n\t\tconst avgRatio = avg(displays.map(i => {\n\t\t\tconst v = getRef(i.id).current!\n\t\t\treturn v.videoWidth / v.videoHeight\n\t\t}))\n\t\tconst closestRatio = [...aspectRatios].sort((a, b) => Math.abs(avgRatio - b.ratio) - Math.abs(avgRatio - a.ratio)).pop()!\n\t\treturn closestRatio\n\t}\n\n\tconst size = React.useMemo(() => getVideoSize(\n\t\taspect.ratio,\n\t\tdisplays.length,\n\t\tviewport\n\t), [aspect, displays, viewport])\n\n\tconst handleDrop = (e:React.DragEvent<HTMLElement>) => {\n\t\tdragSrc && dispatchDisplays(Displays.reorder({\n\t\t\tsrc: displays.indexOf(dragSrc),\n\t\t\tdest: displays.findIndex(i => getRef(i.id).current === e.target) || displays.length - 1\n\t\t}))\n\t}\n\n\treturn <>\n\t\t<main ref={container} onDrop={handleDrop}>\n\t\t\t{displays.length === 0 && <Splash />}\n\t\t\t{displays.map((d, index) => <BDVideo\n\t\t\t\tkey={d.id}\n\t\t\t\tref={getRef(d.id)}\n\t\t\t\tsize={size}\n\t\t\t\tobjectFit={fit}\n\t\t\t\tdisplay={d}\n\t\t\t\tshowThumbnail={showThumbnails.current}\n\t\t\t\thandles={{\n\t\t\t\t\tload: () => dispatch(Settings.setAspect(getRecommendedAspect())),\n\t\t\t\t\tdragStart: () => setDragSrc(d),\n\t\t\t\t\terror: () => setErrors([...errors, d]),\n\t\t\t\t\tmouseOver: () => setActive(index),\n\t\t\t\t\tmouseOut: () => setActive(null),\n\t\t\t\t\tbuttonPress: anyDispatcher\n\t\t\t\t}}\n\t\t\t\tbuttons={[\n\t\t\t\t\t{label: 'X', action: Displays.remove(index)},\n\t\t\t\t\t{label: 'C', action: Displays.copy(index)},\n\t\t\t\t\t{label: 'E', action: Displays.excludeOthers(index)},\n\t\t\t\t\t{label: 'M', action: Displays.updateSettings({index, settings: {muted: {current: !d.settings.muted.current}}})},\n\t\t\t\t\t// I and O don't work - do I update state constantly, or use side effects?\n\t\t\t\t\t{label: 'I', action: Settings.setIn(index)},\n\t\t\t\t\t{label: 'O', action: Settings.setOut(index)},\n\t\t\t\t\t{label: '»', action: Displays.updateSettings({index, settings: {playbackRate: d.settings.playbackRate * 2}})},\n\t\t\t\t\t{label: '«', action: Displays.updateSettings({index, settings: {playbackRate: d.settings.playbackRate / 2}})}\n\t\t\t\t]}\n\t\t\t/>)}\n\t\t</main>\n\t\t{errors.length > 0 && <ErrorDisplay errors={errors} onClose={()=>setErrors([])} />}\n\t\t{help && <Help />}\n\t</>\n}\n\nexport default App","export const getVideoSize = (aspectRatio:number, objects:number, constraints:{width:number,height:number}) => {\r\n\t// try every number of rows up to a dedicated row for each video\r\n\tlet bestArea = 0, width = 0, height = 0\r\n\tfor (let rows = 1; rows <= objects; rows++) {\r\n\t\t// get the necessary number of columns with a given number of rows\r\n\t\tconst cols = Math.ceil(objects / rows)\r\n\t\t// this determines the size of the resulting box\r\n\t\tconst x = Math.floor(constraints.width / cols)\r\n\t\tconst y = Math.floor(constraints.height / rows)\r\n\t\t// actual video dimensions will depend on ratio within the display box, being shrunk on one side\r\n\t\tlet vx = x, vy = y\r\n\t\tif (aspectRatio > x/y) {\r\n\t\t\tvy = vx / aspectRatio\r\n\t\t} else {\r\n\t\t\tvx = vy * aspectRatio\r\n\t\t}\r\n\t\tconst videoArea = vx * vy\r\n\t\t// if this isn't an improvement, continue looking\r\n\t\tif (videoArea < bestArea) continue\r\n\t\t// otherwise save this as best situation\r\n\t\tbestArea = videoArea\r\n\t\twidth = x\r\n\t\theight = y\r\n\t}\r\n\r\n\treturn {width, height}\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === '[::1]' ||\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\n\t\twindow.location.hostname.match(\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n\t\t)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error('Error during service worker registration:', error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl)\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get('content-type');\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null && contentType.indexOf('javascript') === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log(\n\t\t\t\t'No internet connection found. App is running in offline mode.'\n\t\t\t);\n\t\t});\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\tregistration.unregister();\n\t\t});\n\t}\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport {Provider} from 'react-redux'\nimport App from './App'\nimport {store} from './reducers/RootReducer'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<Provider store={store}><App /></Provider>, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister()\nserviceWorker.register()\n"],"sourceRoot":""}