{"version":3,"sources":["FullScreen.ts","browser.ts","components/IOMarker.tsx","BDVideo.tsx","AppAPI.ts","components/Help.tsx","components/ErrorDisplay.tsx","components/Splash.tsx","useAPI.ts","App.tsx","getVideoSize.ts","serviceWorker.js","index.js"],"names":["fullscreenElement","element","requestFullscreen","msRequestFullscreen","webkitRequestFullscreen","call","fsEnabled","document","fullscreenEnabled","msFullscreenEnabled","webkitFullscreenEnabled","fsExit","exitFullscreen","msExitFullscreen","webkitExitFullscreen","bind","browser","navigator","userAgent","indexOf","msBrowser","margins","edge","left","right","bottom","chrome","diameter","IOMarker","_ref","offset","color","style","react_default","a","createElement","className","width","height","viewBox","cx","cy","r","fill","dragMargin","thumbnailMargin","overlayDuration","BDVideo","inTime","outTime","playbackRate","showThumbnail","display","onLoad","onError","onDrag","size","onMouseOver","onMouseOut","objectFit","showOverlay","removeCallback","copyCallback","exclusiveCallback","inCallback","outCallback","speedCallback","_React$useState","React","useState","_React$useState2","Object","slicedToArray","video","setVideo","v","vRef","useCallback","node","_React$useState3","_React$useState4","overlayTimeout","setOverlayTimeout","_React$useState5","_React$useState6","thumbnailState","setThumbnailState","useEffect","ontimeupdate","e","pastOut","currentTime","beforeIn","hoverThumbnail","layerY","undefined","timelineWidth","videoPercentage","layerX","targetTime","duration","timestamp","adjustDisplayTime","adjustment","arguments","length","onmouseover","startTime","onload","onerror","onloadeddata","onloadedmetadata","ondragstart","target","offsetY","preventDefault","onmousemove","clearTimeout","setTimeout","onmouseout","shiftDisplayActions","arrowleft","arrowright","f","displayActions","m","muted","tryActions","actions","key","assign","onKeyDown","ev","toLowerCase","shiftKey","objectSpread","pointerEvents","concat","file","name","onClick","BDVideo_IOBar","BDVideo_Thumbnail","src","url","controls","autoPlay","loop","draggable","ref","Thumbnail","_ref2","_ref2$width","useRef","current","IOBar","_ref3","Fragment","ip","op","ix","ox","objectFits","getDisplayCopy","id","uuid","getNext","list","removeItem","i","toConsumableArray","slice","AppAPI","state","setState","applyToActive","modifier","prev","active","displays","applyToAll","map","setPartialState","partial","toggleHelp","showHelp","toggleThumbnails","showThumbnails","nextAspect","aspect","aspectRatios","nextFit","fit","setViewport","viewport","setExclusive","activeIndex","removeActive","copyDisplay","addCopies","copies","Array","updateDisplay","updates","setActiveIO","marker","d","defineProperty","adjustActivePlaybackRate","syncPlaybackRates","addFiles","files","newDisplays","URL","createObjectURL","triggerResize","firstLoad","handleDisplayError","errorDisplays","dismissErrors","distributeTimes","sourceDisplay","sourceVideo","sourceFile","matchingDisplays","filter","di","orderedDisplays","t1","spacing","forEach","reorderDisplays","destVideo","dragSrc","si","findIndex","SHORTCUTS","DISCLAIMER","SelectInput","props","htmlFor","label","value","onChange","callback","choices","Help","toUpperCase","substr","objectFitCallback","AspectRatios","aspectRatio","toString","aspectRatioCallback","parseInt","ErrorDisplay","dismissCallback","type","onSubmit","Splash","useAPI","apiFactory","initialState","_useState","_useState2","useMemo","avg","arr","reduce","b","stopEvent","stopPropagation","App","api","globalActions","body","msFullscreenElement","webkitFullscreenElement","toggleFullscreen","h","s","t","x","handleResize","clientWidth","clientHeight","useLayoutEffect","window","onresize","ondragover","ondragenter","ondragleave","onkeydown","ctrlKey","ctrlDisplayActions","delete","c","o","ondrop","dataTransfer","droppedFiles","from","getRecommendedAspect","avgRatio","videoWidth","videoHeight","sort","Math","abs","ratio","pop","objects","constraints","bestArea","rows","cols","ceil","floor","y","vx","vy","videoArea","getVideoSize","onDrop","BDVideo_BDVideo","in","out","staggerCallback","components_Help","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","src_App","getElementById","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.ce1e848b.chunk.js","sourcesContent":["export function fullscreenElement(element:HTMLElement) {\r\n\t(element.requestFullscreen || (element as any).msRequestFullscreen || (element as any).webkitRequestFullscreen).call(element)\r\n}\r\n\r\nconst fsEnabled = document.fullscreenEnabled || (document as any).msFullscreenEnabled || (document as any).webkitFullscreenEnabled\r\nconst fsExit = (document.exitFullscreen || (document as any).msExitFullscreen || (document as any).webkitExitFullscreen).bind(document)\r\nexport function toggleFullscreen(target:HTMLElement = document.body) {\r\n\tif (!fsEnabled) return\r\n\tconst fsElement = document.fullscreenElement || (document as any).msFullscreenElement || (document as any).webkitFullscreenElement\r\n\tif (fsElement) {\r\n\t\tfsExit()\r\n\t} else {\r\n\t\tfullscreenElement(target)\r\n\t}\r\n}\r\n","function getBrowser() {\r\n\tif (navigator.userAgent.indexOf(' Trident/') > -1) return 'IE'\r\n\tif (navigator.userAgent.indexOf(' Edge/') > -1) return 'Edge'\r\n\treturn 'Chrome'\r\n}\r\n\r\nconst videoMargins = {\r\n\t\"edge\": {\r\n\t\t\"left\": 116,\r\n\t\t\"right\": 220,\r\n\t\t\"bottom\": 24\r\n\t},\r\n\t\"chrome\": {\r\n\t\t\"left\": 24,\r\n\t\t\"right\": 24,\r\n\t\t\"bottom\": 16\r\n\t}\r\n}\r\n\r\n\r\nexport const browser = getBrowser()\r\nexport const msBrowser = [\"Edge\",\"IE\"].indexOf(browser) > -1\r\nexport const margins = videoMargins[browser === \"Chrome\" ? 'chrome' : 'edge']","import React from 'react'\r\nimport { margins } from '../browser'\r\n\r\ntype IOMarkerProps = {\r\n\toffset:number\r\n\tcolor:string\r\n}\r\n\r\nconst diameter = 10\r\nexport function IOMarker({offset, color}:IOMarkerProps) {\r\n\tconst style = {\r\n\t\tbottom: margins.bottom + (diameter/2),\r\n\t\tleft: margins.left + offset - (diameter/2)\r\n\t}\r\n\treturn <svg className=\"iomarker\"\r\n\t\twidth={diameter} height={diameter}\r\n\t\tviewBox={`0 0 2 2`} style={style}>\r\n\t\t<circle cx={1} cy={1} r={1} fill={color} />\r\n\t</svg>\r\n}","import React from 'react'\r\nimport { ObjectFitProperty } from 'csstype'\r\nimport { fullscreenElement } from './FullScreen'\r\nimport { margins, browser, msBrowser } from './browser'\r\nimport { IOMarker } from './components/IOMarker'\r\nimport './BDVideo.css'\r\n\r\nexport type Display = {\r\n\tid:string\r\n\tfile:File\r\n\turl:string\r\n\tstartTime?:number\r\n\tin?:number\r\n\tout?:number\r\n\tvideo?:HTMLVideoElement\r\n\ttriggerResize:boolean\r\n\tplaybackRate:number\r\n}\r\n\r\ntype BDVideoProps = {\r\n\tdisplay:Display\r\n\tobjectFit:ObjectFitProperty\r\n\tsize: {\r\n\t\twidth:number\r\n\t\theight:number\r\n\t}\r\n\tshowOverlay:boolean\r\n\tshowThumbnail:boolean\r\n\tinTime?:number\r\n\toutTime?:number\r\n\tplaybackRate:number\r\n\tonMouseOver:()=>void\r\n\tonMouseOut:()=>void\r\n\tonLoad:()=>void\r\n\tonError:()=>void\r\n\tonDrag:(display:Display)=>void\r\n\tremoveCallback:()=>void,\r\n\tcopyCallback:()=>void,\r\n\texclusiveCallback:()=>void,\r\n\tstaggerCallback:()=>void,\r\n\tinCallback:()=>void,\r\n\toutCallback:()=>void,\r\n\tspeedCallback:(adjustment:number)=>void\r\n}\r\n\r\ntype ThumbnailState = {\r\n\toffset:number // x-axis mouse position\r\n\ttimestamp:number\r\n}\r\n\r\nconst dragMargin = 80\r\nconst thumbnailWidth = 196\r\nconst thumbnailMargin = margins.bottom + 8\r\n\r\nconst overlayDuration = 3000\r\nexport function BDVideo({inTime, outTime, playbackRate, showThumbnail, display,\r\n\tonLoad, onError, onDrag, size, onMouseOver, onMouseOut,\r\n\tobjectFit, showOverlay, removeCallback, copyCallback, exclusiveCallback,\r\n\tinCallback, outCallback, speedCallback}:BDVideoProps) {\r\n\r\n\tconst [video, setVideo] = React.useState<HTMLVideoElement>()\r\n\tconst v = video!\r\n\tconst vRef = React.useCallback((node:HTMLVideoElement) => {\r\n\t\tsetVideo(node)\r\n\t}, [])\r\n\r\n\tconst [overlayTimeout, setOverlayTimeout] = React.useState<NodeJS.Timeout|undefined>()\r\n\tconst [thumbnailState, setThumbnailState] = React.useState<ThumbnailState|undefined>()\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tv.ontimeupdate = e => {\r\n\t\t\tconst pastOut = outTime && outTime < v.currentTime\r\n\t\t\tconst beforeIn = inTime && inTime > v.currentTime\r\n\t\t\tif (pastOut || beforeIn) v.currentTime = inTime || 0\r\n\t\t}\r\n\t}, [inTime, outTime, v])\r\n\r\n\tconst hoverThumbnail = React.useCallback((e:MouseEvent) => {\r\n\t\tconst distanceFromBottom = v.height - e.layerY\r\n\t\tif (distanceFromBottom > thumbnailMargin) {\r\n\t\t\treturn setThumbnailState(undefined)\r\n\t\t}\r\n\t\tconst timelineWidth = v.width - margins.left - margins.right\r\n\t\tconst videoPercentage = (e.layerX - margins.left) / timelineWidth \r\n\t\tif (videoPercentage < 0 || videoPercentage > 1) {\r\n\t\t\treturn setThumbnailState(undefined)\r\n\t\t}\r\n\t\tconst targetTime = v.duration * videoPercentage\r\n\t\tsetThumbnailState({\r\n\t\t\toffset: e.layerX,\r\n\t\t\ttimestamp: targetTime\r\n\t\t})\r\n\t}, [v])\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tv.playbackRate = playbackRate\r\n\t}, [playbackRate, v])\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tv.onmouseover = showThumbnail && browser !== 'IE' ? hoverThumbnail : null\r\n\t}, [showThumbnail, hoverThumbnail, v])\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tdisplay.video = v\r\n\t\tif (display.startTime) {\r\n\t\t\tv.onload = () => { v.currentTime = display.startTime! }\r\n\t\t} else {\r\n\t\t\tv.onerror = onError\r\n\t\t\tv.onloadeddata = e => v.currentTime = v.duration / 2\r\n\t\t\tv.onloadedmetadata = onLoad\r\n\t\t}\r\n\t\tv.ondragstart = e => {\r\n\t\t\tconst target = e.target! as HTMLVideoElement\r\n\t\t\tconst distanceFromBottom = target.height - e.offsetY\r\n\t\t\tif (distanceFromBottom < dragMargin) {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tonDrag(display)\r\n\t\t}\r\n\t\tv.onmousemove = e => {\r\n\t\t\tshowThumbnail && browser !== 'IE' && hoverThumbnail(e)\r\n\t\t\toverlayTimeout && clearTimeout(overlayTimeout)\r\n\t\t\tsetOverlayTimeout(setTimeout(()=>setOverlayTimeout(undefined), overlayDuration))\r\n\t\t}\r\n\t\tv.onmouseout = e => {\r\n\t\t\tsetThumbnailState(undefined)\r\n\t\t}\r\n\t}, [display, hoverThumbnail, onDrag, onError, onLoad, overlayTimeout, showThumbnail, v])\r\n\r\n\r\n\tfunction adjustDisplayTime(adjustment:number, percentage:boolean = false) {\r\n\t\tif (percentage) adjustment = v.duration * adjustment\r\n\t\tv.currentTime = (v.currentTime + adjustment + v.duration) % v.duration\r\n\t}\r\n\r\n\tconst shiftDisplayActions = {\r\n\t\t\"arrowleft\": () => adjustDisplayTime(-.1, true),\r\n\t\t\"arrowright\": () => adjustDisplayTime(.1, true),\r\n\t\t\"f\": () => v && fullscreenElement(v)\r\n\t}\r\n\tconst displayActions = {\r\n\t\t\"m\": () => { v.muted = !v.muted },\r\n\t\t\"arrowleft\": () => adjustDisplayTime(-60),\r\n\t\t\"arrowright\": () => adjustDisplayTime(60),\r\n\t}\r\n\r\n\tfunction tryActions(actions:{[key:string]:()=>void}, key:string) {\r\n\t\tkey in actions && actions[key]()\r\n\t}\r\n\r\n\tfunction handleDisplayKeyDown(ev:React.KeyboardEvent<HTMLDivElement>) {\r\n\t\tconst key = ev.key.toLowerCase()\r\n\t\tif (ev.shiftKey) {\r\n\t\t\ttryActions(shiftDisplayActions, key)\r\n\t\t} else {\r\n\t\t\ttryActions(displayActions, key)\r\n\t\t}\r\n\t}\r\n\r\n\treturn <div className=\"display\" {...size} onMouseOver={onMouseOver} onMouseOut={onMouseOut} onKeyDown={handleDisplayKeyDown}>\r\n\t\t{overlayTimeout && <div className=\"display-border\" style={{...size, pointerEvents: msBrowser ? 'none' : 'auto'}}>\r\n\t\t\t{`${display.file.name}${playbackRate === 1 ? \"\" : \" (\"+playbackRate+\"x)\"}`}\r\n\t\t</div>}\r\n\t\t{overlayTimeout && <div className=\"display-controls\">\r\n\t\t\t<button onClick={removeCallback}>X</button>\r\n\t\t\t<button onClick={copyCallback}>C</button>\r\n\t\t\t<button onClick={exclusiveCallback}>E</button>\r\n\t\t\t<button onClick={inCallback}>I</button>\r\n\t\t\t<button onClick={outCallback}>O</button>\r\n\t\t\t<button onClick={() => speedCallback(2)}>&raquo;</button>\r\n\t\t\t<button onClick={() => speedCallback(0.5)}>&laquo;</button>\r\n\t\t</div>}\r\n\t\t{showOverlay && <IOBar {...{inTime, outTime}} video={video!} />}\r\n\t\t{showThumbnail && thumbnailState && <Thumbnail src={display.url} {...thumbnailState} />}\r\n\t\t<video controls={true} autoPlay={true} loop={true} muted={true} src={display.url} draggable={!msBrowser}\r\n\t\t\t{...size} ref={vRef} style={{objectFit}} />\r\n\t</div>\r\n}\r\n\r\ntype ThumbnailProps = {\r\n\tsrc:string\r\n\toffset:number\r\n\ttimestamp:number\r\n\twidth?:number\r\n}\r\nconst Thumbnail = ({src, offset, timestamp, width=thumbnailWidth}:ThumbnailProps) => {\r\n\tconst video = React.useRef<HTMLVideoElement>(null)\r\n\tReact.useEffect(() => {\r\n\t\tvideo.current!.currentTime = timestamp\r\n\t}, [timestamp])\r\n\r\n\treturn <video className=\"thumbnail\"\r\n\t\tref={video}\r\n\t\tcontrols={false} autoPlay={false} loop={false} muted={true}\r\n\t\tsrc={src} width={width} style={{left: offset - (width / 2)}} />\r\n}\r\n\r\ntype IOBarProps = {\r\n\tinTime?:number\r\n\toutTime?:number\r\n\tvideo:HTMLVideoElement\r\n}\r\n\r\nconst IOBar = ({inTime, outTime, video}:IOBarProps) => {\r\n\tif (!(inTime || outTime)) return <></>\r\n\tconst duration = video.duration\r\n\tconst ip = inTime || 0\r\n\tconst op = outTime || duration\r\n\tconst timelineWidth = video.width - margins.left - margins.right\r\n\tconst ix = (ip / duration) * timelineWidth\r\n\tconst ox = (op / duration) * timelineWidth\r\n\treturn <>\r\n\t\t<IOMarker offset={ix} color=\"gold\" />\r\n\t\t<IOMarker offset={ox} color=\"gold\" />\r\n\t</>\r\n}","import uuid from 'uuid'\r\nimport {ObjectFitProperty} from 'csstype'\r\nimport {ApiFactoryProps} from './useAPI'\r\nimport { Display } from './BDVideo'\r\nimport aspectRatios from './AspectRatios.json'\r\n\r\nexport const objectFits:ObjectFitProperty[] = ['contain', 'cover', 'fill', 'scale-down']\r\nexport type AspectRatio = typeof aspectRatios[number]\r\n\r\ntype Viewport = {\r\n\twidth:number\r\n\theight:number\r\n}\r\ntype AppState = {\r\n\tshowHelp:boolean\r\n\tshowThumbnails:boolean\r\n\tfirstLoad:boolean\r\n\r\n\tfit:ObjectFitProperty\r\n\taspect:AspectRatio\r\n\r\n\tactive?:Display\r\n\tdragSrc?:Display\r\n\r\n\tdisplays:Display[]\r\n\terrorDisplays:Display[]\r\n\r\n\tviewport?:Viewport\r\n}\r\n\r\nconst getDisplayCopy = (display:Display) => ({\r\n\t...display,\r\n\tid: uuid(),\r\n\tstartTime: display.video ? (display.video.currentTime + 60) % display.video.duration : 0\r\n})\r\n\r\nconst getNext = <T,>(list:T[], current:T) =>\r\n\tlist[(list.indexOf(current) + 1) % list.length]\r\n\r\nconst removeItem = <T,>(list:T[], target:T) => {\r\n\tconst i = list.indexOf(target)\r\n\treturn [...list.slice(0,i), ...list.slice(i+1)]\r\n}\r\n\r\nexport const AppAPI = ({state, setState}:ApiFactoryProps<AppState>) => {\r\n\tconst setPartialState = (partial:Partial<AppState>) => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\t...partial\r\n\t\t}))\r\n\t}\r\n\tconst toggleHelp = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tshowHelp: !prev.showHelp\r\n\t\t}))\r\n\t}\r\n\r\n\tconst toggleThumbnails = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tshowThumbnails: !prev.showThumbnails\r\n\t\t}))\r\n\t}\r\n\r\n\tconst nextAspect = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\taspect: getNext(aspectRatios, prev.aspect)\r\n\t\t}))\r\n\t}\r\n\r\n\tconst nextFit = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tfit: getNext([...objectFits], prev.fit)\r\n\t\t}))\r\n\t}\r\n\r\n\tconst setViewport = (viewport:Viewport) => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tviewport\r\n\t\t}))\r\n\t}\r\n\r\n\tconst setExclusive = (display:Display) => {\r\n\t\tsetState(prev => {\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tactiveIndex: 0,\r\n\t\t\t\tdisplays: [display]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst removeActive = () => {\r\n\t\tsetState(prev => {\r\n\t\t\tif (prev.active === undefined) return prev\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: removeItem(prev.displays, prev.active),\r\n\t\t\t\tactive: undefined\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst reorderDisplays = (destVideo:EventTarget) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst src = prev.dragSrc\r\n\t\t\tif (src === undefined) return prev\r\n\t\t\tconst displays = prev.displays\r\n\t\t\tconst si = displays.indexOf(src)\r\n\t\t\tconst di = displays.findIndex(i => i.video === destVideo) || displays.length - 1\r\n\t\t\tconst newDisplays = si > di ? [\r\n\t\t\t\t...displays.slice(0, di),\r\n\t\t\t\tdisplays[si],\r\n\t\t\t\t...displays.slice(di, si),\r\n\t\t\t\t...displays.slice(si+1)\r\n\t\t\t] : [\r\n\t\t\t\t...displays.slice(0, si),\r\n\t\t\t\t...displays.slice(si+1, di+1),\r\n\t\t\t\tdisplays[si],\r\n\t\t\t\t...displays.slice(di+1)\r\n\t\t\t]\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: newDisplays\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst copyDisplay = (display:Display) => {\r\n\t\tsetState(prev => {\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: [...prev.displays, getDisplayCopy(display)]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst addCopies = (copies:number) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst active = prev.active\r\n\t\t\tif (active === undefined) return prev\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: [...prev.displays, ...[...Array(copies)].map(()=>getDisplayCopy(active))]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst updateDisplay = (display:Display, updates:Partial<Display>) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst displays = [...prev.displays]\r\n\t\t\tconst i = displays.indexOf(display)\r\n\t\t\t// shallow effect only!\r\n\t\t\tdisplays[i] = {...displays[i], ...updates}\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst applyToActive = (modifier:(display:Display)=>Partial<Display>) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst active = prev.active\r\n\t\t\tif (active === undefined) return prev\r\n\t\t\tconst i = prev.displays.indexOf(active)\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: [\r\n\t\t\t\t\t...prev.displays.slice(0, i),\r\n\t\t\t\t\t{...active, ...modifier(active)},\r\n\t\t\t\t\t...prev.displays.slice(i+1)\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst applyToAll = (modifier:(display:Display)=>Partial<Display>) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst displays = prev.displays.map(i=>({...i, ...modifier(i)}))\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\t...displays\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst setActiveIO = (marker:'in'|'out') => {\r\n\t\tapplyToActive(d => ({[marker]: d.video!.currentTime}))\r\n\t}\r\n\r\n\tconst adjustActivePlaybackRate = (adjustment:number) => {\r\n\t\tapplyToActive(d=>({playbackRate: d.playbackRate * adjustment}))\r\n\t}\r\n\r\n\tconst syncPlaybackRates = (playbackRate:number) => {\r\n\t\tapplyToAll(d=>({playbackRate}))\r\n\t}\r\n\r\n\tconst addFiles = (files:File[]) => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst newDisplays = files.map(file => ({\r\n\t\t\t\tid: uuid(),\r\n\t\t\t\tfile,\r\n\t\t\t\turl: URL.createObjectURL(file),\r\n\t\t\t\ttriggerResize: prev.firstLoad,\r\n\t\t\t\tplaybackRate: 1\r\n\t\t\t}))\r\n\t\t\treturn ({\r\n\t\t\t\t...prev,\r\n\t\t\t\tfirstLoad: false,\r\n\t\t\t\tshowHelp: prev.showHelp && newDisplays.length === 0,\r\n\t\t\t\tdisplays: [...prev.displays, ...newDisplays]\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tconst handleDisplayError = () => {\r\n\t\tsetState(prev => {\r\n\t\t\tconst active = prev.active\r\n\t\t\tif (active === undefined) return prev\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tdisplays: removeItem(prev.displays, active),\r\n\t\t\t\terrorDisplays: [...prev.errorDisplays, active]\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst dismissErrors = () => {\r\n\t\tsetState(prev => ({\r\n\t\t\t...prev,\r\n\t\t\terrorDisplays: []\r\n\t\t}))\r\n\t}\r\n\r\n\r\n\tconst distributeTimes = (sourceDisplay:Display) => {\r\n\t\tconst sourceVideo = sourceDisplay.video\r\n\t\tif (!sourceVideo) return\r\n\t\tconst sourceFile = sourceDisplay.file\r\n\r\n\t\tsetState(prev => {\r\n\t\t\tconst matchingDisplays = prev.displays.filter(i => i.file === sourceFile)\r\n\t\t\tconst di = matchingDisplays.indexOf(sourceDisplay)\r\n\t\t\t// start with target display so it keeps its current time, bump up from there looping back to start\r\n\t\t\tconst orderedDisplays = [sourceDisplay, ...matchingDisplays.slice(di+1), ...matchingDisplays.slice(0, di)]\r\n\r\n\t\t\tconst t1 = sourceVideo.currentTime\r\n\t\t\tconst duration = sourceVideo.duration\r\n\t\t\tconst spacing = duration / orderedDisplays.length\r\n\t\t\torderedDisplays.forEach((v, i) => {\r\n\t\t\t\tconst targetTime = t1 + (spacing * i)\r\n\t\t\t\t// loop time back to beginning once we exceed end of video\r\n\t\t\t\tv.video!.currentTime = targetTime % duration\r\n\t\t\t})\r\n\t\t\treturn prev\r\n\t\t})\r\n\t}\r\n\r\n\treturn {\r\n\t\t...state,\r\n\t\tsetPartialState,\r\n\t\ttoggleHelp, toggleThumbnails,\r\n\t\tnextAspect,\r\n\t\tnextFit,\r\n\t\tsetViewport,\r\n\t\tsetExclusive,\r\n\t\tremoveActive,\r\n\t\tcopyDisplay, addCopies,\r\n\r\n\t\tupdateDisplay,\r\n\t\tapplyToActive, applyToAll,\r\n\r\n\t\tsetActiveIO, adjustActivePlaybackRate,\r\n\t\tsyncPlaybackRates,\r\n\r\n\t\taddFiles,\r\n\t\thandleDisplayError, dismissErrors,\r\n\r\n\t\tdistributeTimes,\r\n\r\n\t\treorderDisplays\r\n\t}\r\n}","import React from 'react'\r\nimport './Help.css'\r\nimport { ObjectFitProperty } from \"csstype\"\r\nimport {objectFits} from '../AppAPI'\r\nimport AspectRatios from '../AspectRatios.json'\r\ntype AspectRatio = typeof AspectRatios[number]\r\n\r\nconst SHORTCUTS = <section id=\"shortcuts\">\r\n\t<h2>Shortcuts</h2><ol>\r\n\t\t<li><em>C:</em> Clone video (+1m)</li>\r\n\t\t<li><em>D:</em> Distribute times</li>\r\n\t\t<li><em>E:</em> Remove everything else</li>\r\n\t\t<li><em>F:</em> Toggle fullscreen</li>\r\n\t\t<li><em>Shift+F:</em> Fullscreen video</li>\r\n\t\t<li><em>H:</em> Toggle help</li>\r\n\t\t<li><em>I:</em> Toggle in point</li>\r\n\t\t<li><em>O:</em> Toggle out point</li>\r\n\t\t<li><em>M:</em> Toggle mute</li>\r\n\t\t<li><em>R:</em> Remove video</li>\r\n\t\t<li><em>S:</em> Change video scaling</li>\r\n\t\t<li><em>X:</em> Change aspect ratio</li>\r\n\t\t<li><em>← →:</em> Skip 1m</li>\r\n\t\t<li><em>Shift ← →:</em> Skip 10%</li>\r\n\t\t<li><em>Ctrl ← →:</em> Change speed</li>\r\n\t\t<li><em>Shift+S</em> Sync speeds</li>\r\n\t\t<li><em>Ctrl+W:</em> Close tab</li>\r\n\t\t<li><em>O,O:</em> Restart video</li>\r\n\t\t<li><em>2-9:</em> Fill 2-9 size grid</li>\r\n\t\t<li><em>Drag+Drop:</em> Reorder videos</li>\r\n\t</ol>\r\n</section>\r\n\r\nconst DISCLAIMER = <footer>\r\n\t<h2>Privacy Disclaimer</h2>\r\n\t<p>This tool records <b>no</b> filenames, screen grabs, or any other methods of identifying the actual contents of any video.  Only metadata about a video's format (codec, file size, resolution, and duration) may be recorded.</p>\r\n</footer>\r\n\r\ntype HelpSettingsProps = {\r\n\tobjectFit:ObjectFitProperty\r\n\tobjectFitCallback:(v:ObjectFitProperty)=>void\r\n\taspectRatio:AspectRatio\r\n\taspectRatioCallback:(v:AspectRatio)=>void\r\n}\r\n\r\n// const getAR = (v:AspectRatio) => `${v.ratio.toFixed(2)} / ${v.name}`\r\n\r\nexport function Help(props:HelpSettingsProps) {\r\n\treturn <section id=\"help\">\r\n\t\t<h2>Usage</h2>\r\n\t\t<p>Drag and drop any number of videos to auto-play in an optimally arranged grid.</p>\r\n\t\t<section id=\"settings\">\r\n\t\t\t<h2>Settings</h2>\r\n\t\t\t<form>\r\n\t\t\t\t<SelectInput\r\n\t\t\t\t\tname=\"objectScale\" label=\"Video Fit/Fill\"\r\n\t\t\t\t\tvalue={props.objectFit} choices={objectFits.map(v => <option key={v} value={v}>{v[0].toUpperCase()+v.substr(1)}</option>)}\r\n\t\t\t\t\tcallback={v=>props.objectFitCallback(v as ObjectFitProperty)} /><br />\r\n\t\t\t\t<SelectInput\r\n\t\t\t\t\tname=\"aspectRatio\" label=\"Aspect Ratio\"\r\n\t\t\t\t\tvalue={AspectRatios.indexOf(props.aspectRatio).toString()}\r\n\t\t\t\t\tchoices={AspectRatios.map((v, i) => <option key={i} value={i}>{v.name}</option>)}\r\n\t\t\t\t\tcallback={i=>props.aspectRatioCallback(AspectRatios[parseInt(i)])} /><br />\r\n\t\t\t</form>\r\n\t\t</section>\r\n\t\t{SHORTCUTS}\r\n\t\t{DISCLAIMER}\r\n\t</section>\r\n}\r\n\r\nfunction SelectInput(props:{name:string, label:string, value:string, choices:JSX.Element[], callback:(val:string)=>void}) {\r\n\treturn <>\r\n\t\t<label htmlFor={props.name}>{props.label}</label>\r\n\t\t<select name={props.name} value={props.value} onChange={e => props.callback(e.target.value)}>\r\n\t\t\t{props.choices}\r\n\t\t</select>\r\n\t</>\r\n}\r\n\r\n// type NumInputProps = {\r\n// \tvalue:number\r\n// \tname:string\r\n// \tlabel:string\r\n// \tcallback:(num:number)=>void\r\n// }\r\n// const NumInput = ({value,name,label,callback}:NumInputProps) => <>\r\n// \t<label htmlFor={name}>{label}</label>\r\n// \t<input type=\"number\" min={0} maxLength={3} name={name} value={value} onChange={e => callback(parseFloat(e.target.value))} />\r\n// </>\r\n\r\nexport default Help","import React from 'react'\r\nimport {Display} from '../BDVideo'\r\n\r\ntype ErrorDisplayProps = {\r\n\terrorDisplays:Display[]\r\n\tdismissCallback:()=>void\r\n}\r\nexport function ErrorDisplay({errorDisplays, dismissCallback}:ErrorDisplayProps) {\r\n\treturn <section id=\"errors\">\r\n\t\t<h2>Errors</h2><ol>\r\n\t\t\t{errorDisplays.map((display, i) => <li key={i}>{display.file.name} ({display.file.type})</li>)}\r\n\t\t</ol>\r\n\t\t<p>Only videos supported by your web browser will play successfully.  <code>.mp4</code> and <code>.webm</code> files are good bets.</p>\r\n\t\t<form onSubmit={dismissCallback}><button>Dismiss</button></form>\r\n\t</section>\r\n}\r\n","import React from 'react'\r\n\r\n// TODO: add logo\r\nexport function Splash() {\r\n\treturn <section id=\"splash\">\r\n\t\t<p>Auto-play any number of videos or copies of videos in an optimally arranged grid with simple drag-and-drop.  Videos start half-way in and loop, ensuring immediate, continuous immersion, great for scouring surveillance footage, finding the best highlights from your last gaming stream, and more!</p>\r\n\t\t<p>Find your favourite moments quickly with thumbnail scrubbing and keyboard shortcuts to jump ahead in time 1m (→) or 10% (Shift →), or adjust playback speed (Ctrl →).</p>\r\n\t\t<p>Use shortcut keys to rapidly (c)opy or (r)emove displays, set (i)n/(o)ut loop points, (f)ullscreen the display, toggle (m)ute, etc.</p>\r\n\t\t{/* <img src=\"clipart/surveillance.jpg\" alt=\"Surveillance\" />\r\n\t\t<img src=\"clipart/television.jpg\" alt=\"Television\" /> */}\r\n\t</section>\r\n}\r\n\r\n","import {useState, useMemo} from 'react'\r\n\r\nexport type ApiFactoryProps<T> = {\r\n\tstate:T,\r\n\tsetState:(callback:(prevState:T)=>T)=>void\r\n}\r\n\r\nexport const useAPI = <T,V>(apiFactory:(props:ApiFactoryProps<T>)=>V, initialState:T) => {\r\n\tlet [state, setState] = useState(initialState)\r\n\treturn useMemo(\r\n\t\t()=>apiFactory({ state, setState }),\r\n\t\t[state, apiFactory]\r\n\t)\r\n}\r\n\r\n","// TODO: import only required polyfills\n// import 'react-app-polyfill/ie11'\n// import '@babel/polyfill'\n// import 'core-js/modules/es6.array.from'\n\n// TODO: refence react as third party library on cdn?\nimport React from 'react'\nimport { BDVideo } from './BDVideo'\nimport Help from './components/Help'\nimport { toggleFullscreen } from './FullScreen'\nimport { ErrorDisplay } from './components/ErrorDisplay'\nimport { Splash } from './components/Splash'\nimport aspectRatios from './AspectRatios.json'\nimport './App.css'\n\nimport {AppAPI, objectFits} from './AppAPI'\nimport { useAPI } from './useAPI'\nimport {getVideoSize} from './getVideoSize'\n\nconst avg = (arr:number[]) => arr.reduce((a, b) => a + b, 0) / arr.length\n\nfunction stopEvent(e:Event) {\n\te.preventDefault()\n\te.stopPropagation()\n}\n\nfunction tryActions(actions:{[key:string]:()=>void}, key:string) {\n\tkey in actions && actions[key]()\n}\n\nfunction App() {\n\tconst api = useAPI(AppAPI, {\n\t\tshowHelp: true,\n\t\tshowThumbnails: true,\n\t\tfirstLoad: true,\n\t\tdisplays: [],\n\t\terrorDisplays: [],\n\t\taspect: aspectRatios[0],\n\t\tfit: objectFits[0]\n\t})\n\n\tconst viewport = React.useRef<HTMLElement>(null)\n\n\tconst globalActions = {\n\t\t\"f\": () => toggleFullscreen(),\n\t\t\"h\": api.toggleHelp,\n\t\t\"s\": api.nextFit,\n\t\t\"t\": api.toggleThumbnails,\n\t\t\"x\": api.nextAspect\n\t}\n\n\tconst handleResize = () => {\n\t\tconst i = viewport.current!\n\t\tapi.setViewport({\n\t\t\twidth: i.clientWidth,\n\t\t\theight: i.clientHeight\n\t\t})\n\t}\n\tReact.useLayoutEffect(() => {\n\t\twindow.onresize = () => handleResize()\n\t\thandleResize()\n\t\t// eslint-disable-next-line\n\t}, [])\n\n\tReact.useEffect(() => {\n\t\tdocument.ondragover = stopEvent\n\t\tdocument.ondragenter = stopEvent\n\t\tdocument.ondragleave = stopEvent\n\t}, [])\n\n\tReact.useEffect(() => {\n\t\twindow.onkeydown = (ev) => {\n\t\t\tconst key = ev.key.toLowerCase()\n\t\t\tif (key in globalActions && !ev.shiftKey && !ev.ctrlKey) {\n\t\t\t\treturn globalActions[key as keyof typeof globalActions]()\n\t\t\t}\n\n\t\t\tconst i = api.active\n\t\t\tif (i === undefined) return\n\t\t\tconst ctrlDisplayActions = {\n\t\t\t\t\"arrowleft\": () => api.adjustActivePlaybackRate(0.5),\n\t\t\t\t\"arrowright\": () => api.adjustActivePlaybackRate(2)\n\t\t\t}\n\t\t\tconst shiftDisplayActions = {\n\t\t\t\t\"s\": () => api.syncPlaybackRates(i.video!.playbackRate),\n\t\t\t}\n\t\t\tconst displayActions = {\n\t\t\t\t\"delete\": api.removeActive,\n\t\t\t\t\"c\": () => api.copyDisplay(i),\n\t\t\t\t\"d\": () => api.distributeTimes(i),\n\t\t\t\t\"e\": () => api.active && api.setExclusive(api.active),\n\t\t\t\t\"i\": () => api.setActiveIO('in'),\n\t\t\t\t\"o\": () => api.setActiveIO('out'),\n\t\t\t\t\"r\": api.removeActive,\n\t\t\t}\n\n\t\t\tif (ev.shiftKey) {\n\t\t\t\ttryActions(shiftDisplayActions, key)\n\t\t\t} else if (ev.ctrlKey) {\n\t\t\t\ttryActions(ctrlDisplayActions, key)\n\t\t\t} else {\n\t\t\t\ttryActions(displayActions, key)\n\t\t\t\tif (key >= \"2\" && key <= \"9\") {\n\t\t\t\t\tapi.addCopies(parseInt(key))\n\t\t\t\t\tapi.distributeTimes(i)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, [api, globalActions])\n\n\tReact.useEffect(() => {\n\t\tdocument.ondrop = e => {\n\t\t\tstopEvent(e)\n\t\t\tif (!e.dataTransfer) return\n\t\t\tconst droppedFiles = e.dataTransfer.files as FileList\n\t\t\tapi.addFiles(Array.from(droppedFiles))\n\t\t}\n\t}, [api])\n\n\tconst getRecommendedAspect = React.useCallback(() => {\n\t\tconst avgRatio = avg(api.displays.map(i => i.video!.videoWidth / i.video!.videoHeight))\n\t\tconst closestRatio = [...aspectRatios].sort((a, b) => Math.abs(avgRatio - b.ratio) - Math.abs(avgRatio - a.ratio)).pop()!\n\t\treturn closestRatio\n\t}, [api.displays])\n\n\tconst size = React.useMemo(() => getVideoSize(\n\t\tapi.aspect.ratio,\n\t\tapi.displays.length,\n\t\tapi.viewport || {width: 1, height: 1}\n\t), [api.aspect, api.displays, api.viewport])\n\n\treturn <>\n\t\t<main ref={viewport}\n\t\t\tonDrop={e => api.reorderDisplays(e.target)}>\n\t\t\t{api.displays.length === 0 && <Splash />}\n\t\t\t{api.displays.map(i => <BDVideo size={size} objectFit={api.fit} key={i.id} display={i}\n\t\t\t\tshowOverlay={i === api.active}\n\t\t\t\tshowThumbnail={api.showThumbnails}\n\t\t\t\tplaybackRate={i.playbackRate}\n\t\t\t\tonDrag={i => api.setPartialState({dragSrc: i})}\n\t\t\t\tonMouseOver={() => api.setPartialState({active: i})}\n\t\t\t\tonMouseOut={()=>api.setPartialState({active: undefined})}\n\t\t\t\tonLoad={() => i.triggerResize && api.setPartialState({aspect: getRecommendedAspect()})}\n\t\t\t\tonError={() => api.handleDisplayError()}\n\t\t\t\tinTime={i.in} outTime={i.out}\n\t\t\t\tremoveCallback={api.removeActive}\n\t\t\t\tcopyCallback={()=>api.copyDisplay(i)}\n\t\t\t\texclusiveCallback={() => api.setExclusive(i)}\n\t\t\t\tstaggerCallback={() => api.distributeTimes(i)}\n\t\t\t\tinCallback={() => api.setActiveIO(\"in\")}\n\t\t\t\toutCallback={() => api.setActiveIO(\"out\")}\n\t\t\t\tspeedCallback={adjustment => api.adjustActivePlaybackRate(adjustment)}\n\t\t\t/>)}\n\t\t</main>\n\t\t{api.errorDisplays.length > 0 && <ErrorDisplay errorDisplays={api.errorDisplays} dismissCallback={api.dismissErrors} />}\n\t\t{api.showHelp && <Help\n\t\t\taspectRatio={api.aspect}\n\t\t\tobjectFit={api.fit}\n\t\t\taspectRatioCallback={i=>api.setPartialState({aspect: i})}\n\t\t\tobjectFitCallback={i=>api.setPartialState({fit: i})} />}\n\t</>\n}\n\nexport default App","export function getVideoSize(aspectRatio:number, objects:number, constraints:{width:number,height:number}) {\r\n\t// try every number of rows up to a dedicated row for each video\r\n\tlet bestArea = 0, width = 0, height = 0\r\n\tfor (let rows = 1; rows <= objects; rows++) {\r\n\t\t// get the necessary number of columns with a given number of rows\r\n\t\tconst cols = Math.ceil(objects / rows)\r\n\t\t// this determines the size of the resulting box\r\n\t\tconst x = Math.floor(constraints.width / cols)\r\n\t\tconst y = Math.floor(constraints.height / rows)\r\n\t\t// actual video dimensions will depend on ratio within the display box, being shrunk on one side\r\n\t\tlet vx = x, vy = y\r\n\t\tif (aspectRatio > x/y) {\r\n\t\t\tvy = vx / aspectRatio\r\n\t\t} else {\r\n\t\t\tvx = vy * aspectRatio\r\n\t\t}\r\n\t\tconst videoArea = vx * vy\r\n\t\t// if this isn't an improvement, continue looking\r\n\t\tif (videoArea < bestArea) continue\r\n\t\t// otherwise save this as best situation\r\n\t\tbestArea = videoArea\r\n\t\twidth = x\r\n\t\theight = y\r\n\t}\r\n\r\n\treturn {width, height}\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === '[::1]' ||\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\n\t\twindow.location.hostname.match(\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n\t\t)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error('Error during service worker registration:', error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl)\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get('content-type');\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null && contentType.indexOf('javascript') === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log(\n\t\t\t\t'No internet connection found. App is running in offline mode.'\n\t\t\t);\n\t\t});\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\tregistration.unregister();\n\t\t});\n\t}\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister()\nserviceWorker.register()\n"],"sourceRoot":""}