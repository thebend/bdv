{"version":3,"sources":["FullScreen.ts","browser.ts","Thumbnail.tsx","components/IOMarker.tsx","IOBar.tsx","BDVideo.tsx","AppReducer.ts","components/Help.tsx","components/ErrorDisplay.tsx","components/Splash.tsx","App.tsx","getVideoSize.ts","serviceWorker.js","index.js"],"names":["fullscreenElement","element","requestFullscreen","msRequestFullscreen","webkitRequestFullscreen","call","fsEnabled","document","fullscreenEnabled","msFullscreenEnabled","webkitFullscreenEnabled","fsExit","exitFullscreen","msExitFullscreen","webkitExitFullscreen","bind","browser","navigator","userAgent","indexOf","msBrowser","margins","edge","left","right","bottom","chrome","Thumbnail","_ref","src","offset","timestamp","_ref$width","width","video","React","useRef","current","currentTime","react_default","a","createElement","className","ref","controls","autoPlay","loop","muted","style","diameter","IOMarker","color","height","viewBox","cx","cy","r","fill","IOBar","inTime","outTime","duration","ip","op","timelineWidth","ix","ox","Fragment","tryActions","actions","key","dragMargin","thumbnailMargin","useElement","_React$useState","useState","_React$useState2","Object","slicedToArray","setElement","useCallback","i","overlayDuration","BDVideo","showThumbnail","display","onLoad","size","objectFit","dispatch","index","_useElement","_useElement2","v","videoRef","_React$useState3","_React$useState4","overlayTimeout","setOverlayTimeout","_React$useState5","_React$useState6","thumbnailState","setThumbnailState","useEffect","playbackRate","onerror","type","payload","onloadedmetadata","onloadeddata","e","ondragstart","target","offsetY","preventDefault","dragSrc","ontimeupdate","pastOut","out","beforeIn","in","adjustDisplayTime","adjustment","arguments","length","undefined","shiftDisplayActions","arrowleft","arrowright","f","displayActions","m","onMouseOver","activeIndex","onMouseMove","clearTimeout","setTimeout","_ref2","nativeEvent","layerX","layerY","videoPercentage","targetTime","onMouseOut","onKeyDown","ev","shiftKey","toLowerCase","pointerEvents","file","name","concat","onClick","IOBar_IOBar","Thumbnail_Thumbnail","assign","url","draggable","objectFits","getDisplayCopy","objectSpread","id","uuid","startTime","getNext","list","removeIndex","toConsumableArray","slice","AppReducer","state","action","applyToActive","modifier","d","displays","applyToAll","map","aspect","aspectRatios","fit","showHelp","showThumbnails","body","msFullscreenElement","webkitFullscreenElement","toggleFullscreen","si","di","findIndex","Array","_action$payload","updates","marker","defineProperty","newDisplays","URL","createObjectURL","firstLoad","errorDisplays","matchingDisplays","filter","orderedDisplays","t1","spacing","forEach","SHORTCUTS","DISCLAIMER","SelectInput","props","htmlFor","label","value","onChange","callback","choices","Help","toUpperCase","substr","objectFitCallback","AspectRatios","aspectRatio","toString","aspectRatioCallback","parseInt","ErrorDisplay","dismissCallback","onSubmit","Splash","avg","arr","reduce","b","stopEvent","stopPropagation","App","_React$useReducer","useReducer","_React$useReducer2","_React$useReducer2$","objectWithoutProperties","viewport","globalActions","h","s","t","x","useLayoutEffect","handleResize","clientWidth","clientHeight","window","onresize","ondragover","ondragenter","ondragleave","onkeydown","ctrlKey","ctrlDisplayActions","delete","c","o","ondrop","dataTransfer","droppedFiles","files","from","getRecommendedAspect","avgRatio","videoWidth","videoHeight","sort","Math","abs","ratio","pop","useMemo","objects","constraints","bestArea","rows","cols","ceil","floor","y","vx","vy","videoArea","getVideoSize","onDrop","BDVideo_BDVideo","components_Help","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","error","ReactDOM","render","src_App","getElementById","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.4d6cbfb7.chunk.js","sourcesContent":["export function fullscreenElement(element:HTMLElement) {\r\n\t(element.requestFullscreen || (element as any).msRequestFullscreen || (element as any).webkitRequestFullscreen).call(element)\r\n}\r\n\r\nconst fsEnabled = document.fullscreenEnabled || (document as any).msFullscreenEnabled || (document as any).webkitFullscreenEnabled\r\nconst fsExit = (document.exitFullscreen || (document as any).msExitFullscreen || (document as any).webkitExitFullscreen).bind(document)\r\nexport function toggleFullscreen(target:HTMLElement = document.body) {\r\n\tif (!fsEnabled) return\r\n\tconst fsElement = document.fullscreenElement || (document as any).msFullscreenElement || (document as any).webkitFullscreenElement\r\n\tif (fsElement) {\r\n\t\tfsExit()\r\n\t} else {\r\n\t\tfullscreenElement(target)\r\n\t}\r\n}\r\n","function getBrowser() {\r\n\tif (navigator.userAgent.indexOf(' Trident/') > -1) return 'IE'\r\n\tif (navigator.userAgent.indexOf(' Edge/') > -1) return 'Edge'\r\n\treturn 'Chrome'\r\n}\r\n\r\nconst videoMargins = {\r\n\t\"edge\": {\r\n\t\t\"left\": 116,\r\n\t\t\"right\": 220,\r\n\t\t\"bottom\": 24\r\n\t},\r\n\t\"chrome\": {\r\n\t\t\"left\": 24,\r\n\t\t\"right\": 24,\r\n\t\t\"bottom\": 16\r\n\t}\r\n}\r\n\r\n\r\nexport const browser = getBrowser()\r\nexport const msBrowser = [\"Edge\",\"IE\"].indexOf(browser) > -1\r\nexport const margins = videoMargins[browser === \"Chrome\" ? 'chrome' : 'edge']","import React from 'react'\r\nconst thumbnailWidth = 196\r\n\r\ntype ThumbnailProps = {\r\n\tsrc:string\r\n\toffset:number\r\n\ttimestamp:number\r\n\twidth?:number\r\n}\r\n\r\nexport const Thumbnail = ({src, offset, timestamp, width=thumbnailWidth}:ThumbnailProps) => {\r\n\tconst video = React.useRef<HTMLVideoElement>(null)\r\n\tif (video.current) video.current.currentTime = timestamp\r\n\r\n\treturn <video className=\"thumbnail\"\r\n\t\tref={video}\r\n\t\tcontrols={false} autoPlay={false} loop={false} muted={true}\r\n\t\tsrc={src} width={width} style={{left: offset - (width / 2)}} />\r\n}\r\n","import React from 'react'\r\nimport { margins } from '../browser'\r\n\r\ntype IOMarkerProps = {\r\n\toffset:number\r\n\tcolor:string\r\n}\r\n\r\nconst diameter = 10\r\nexport function IOMarker({offset, color}:IOMarkerProps) {\r\n\tconst style = {\r\n\t\tbottom: margins.bottom + (diameter/2),\r\n\t\tleft: margins.left + offset - (diameter/2)\r\n\t}\r\n\treturn <svg className=\"iomarker\"\r\n\t\twidth={diameter} height={diameter}\r\n\t\tviewBox={`0 0 2 2`} style={style}>\r\n\t\t<circle cx={1} cy={1} r={1} fill={color} />\r\n\t</svg>\r\n}","import React from 'react'\r\nimport { IOMarker } from './components/IOMarker'\r\nimport { margins } from './browser'\r\n\r\ntype IOBarProps = {\r\n\tinTime?:number\r\n\toutTime?:number\r\n\tvideo:HTMLVideoElement\r\n}\r\n\r\nexport const IOBar = ({inTime, outTime, video}:IOBarProps) => {\r\n\tif (!(inTime || outTime)) return null\r\n\tconst duration = video.duration\r\n\tconst ip = inTime || 0\r\n\tconst op = outTime || duration\r\n\tconst timelineWidth = video.width - margins.left - margins.right\r\n\tconst ix = (ip / duration) * timelineWidth\r\n\tconst ox = (op / duration) * timelineWidth\r\n\treturn <>\r\n\t\t<IOMarker offset={ix} color=\"gold\" />\r\n\t\t<IOMarker offset={ox} color=\"gold\" />\r\n\t</>\r\n}","import React from 'react'\r\nimport { ObjectFitProperty } from 'csstype'\r\nimport { fullscreenElement } from './FullScreen'\r\nimport { margins, browser, msBrowser } from './browser'\r\nimport { Thumbnail } from './Thumbnail'\r\nimport { IOBar } from './IOBar'\r\nimport './BDVideo.css'\r\nimport { AppAction } from './AppReducer';\r\n\r\nexport type Display = {\r\n\tid:string\r\n\tfile:File\r\n\turl:string\r\n\tin?:number\r\n\tout?:number\r\n\tvideo?:HTMLVideoElement\r\n\t// triggerResize:boolean\r\n\tplaybackRate:number\r\n}\r\n\r\ntype BDVideoProps = {\r\n\tdisplay:Display\r\n\tobjectFit:ObjectFitProperty\r\n\tsize: {\r\n\t\twidth:number\r\n\t\theight:number\r\n\t}\r\n\tshowThumbnail:boolean\r\n\tdispatch:(value:AppAction)=>void\r\n\tindex:number\r\n\tonLoad:()=>void\r\n}\r\n\r\nconst tryActions = (actions:{[key:string]:()=>void}, key:string) =>\r\n\tkey in actions && actions[key]()\r\n\r\ntype ThumbnailState = {\r\n\toffset:number // x-axis mouse position\r\n\ttimestamp:number\r\n}\r\n\r\nconst dragMargin = 80\r\nconst thumbnailMargin = margins.bottom + 8\r\n\r\nconst useElement = <T,>() => {\r\n\tconst [element, setElement] = React.useState<T>()\r\n\tconst ref = React.useCallback((i:T)=>setElement(i), [])\r\n\treturn [element!, ref] as const\r\n}\r\n\r\nconst overlayDuration = 3000\r\nexport function BDVideo({showThumbnail, display,\r\n\tonLoad, size, objectFit, dispatch, index}:BDVideoProps) {\r\n\r\n\tconst [v, videoRef] = useElement<HTMLVideoElement>()\r\n\r\n\tconst [overlayTimeout, setOverlayTimeout] = React.useState<NodeJS.Timeout>()\r\n\tconst [thumbnailState, setThumbnailState] = React.useState<ThumbnailState>()\r\n\r\n\tconst handleMouseOver = () => {\r\n\t\t// v.focus()\r\n\t\tdispatch({type: 'setPartialState', payload: {activeIndex: index}})\r\n\t}\r\n\tconst handleMouseOut = () => {\r\n\t\tsetThumbnailState(undefined)\r\n\t\tdispatch({type: 'setPartialState', payload: {activeIndex: undefined}})\r\n\t}\r\n\tconst handleMouseMove = (e:React.MouseEvent) => {\r\n\t\toverlayTimeout && clearTimeout(overlayTimeout)\r\n\t\tsetOverlayTimeout(setTimeout(()=>setOverlayTimeout(undefined), overlayDuration))\r\n\r\n\t\tif (!showThumbnail || browser === 'IE') return\r\n\t\tconst [layerX, layerY] = [e.nativeEvent.layerX, e.nativeEvent.layerY]\r\n\t\tconst distanceFromBottom = v.height - layerY\r\n\t\tif (distanceFromBottom > thumbnailMargin) {\r\n\t\t\treturn setThumbnailState(undefined)\r\n\t\t}\r\n\t\tconst timelineWidth = v.width - margins.left - margins.right\r\n\t\tconst videoPercentage = (layerX - margins.left) / timelineWidth \r\n\t\tif (videoPercentage < 0 || videoPercentage > 1) {\r\n\t\t\treturn setThumbnailState(undefined)\r\n\t\t}\r\n\t\tconst targetTime = v.duration * videoPercentage\r\n\t\tsetThumbnailState({\r\n\t\t\toffset: layerX,\r\n\t\t\ttimestamp: targetTime\r\n\t\t})\r\n\t}\r\n\r\n\tReact.useEffect(() => {\r\n\t\tif (!v) return\r\n\t\tdisplay.video = v\r\n\t\tv.playbackRate = display.playbackRate\r\n\r\n\t\tv.onerror = () => dispatch({type: 'handleDisplayError', payload: index})\r\n\t\tv.onloadedmetadata = onLoad\r\n\t\tv.onloadeddata = e => v.currentTime = v.duration / 2\r\n\t\tv.ondragstart = e => {\r\n\t\t\tconst target = e.target! as HTMLVideoElement\r\n\t\t\tconst distanceFromBottom = target.height - e.offsetY\r\n\t\t\tif (distanceFromBottom < dragMargin) e.preventDefault()\r\n\t\t\telse dispatch({type: 'setPartialState', payload: {dragSrc: display}})\r\n\t\t}\r\n\t\tv.ontimeupdate = e => {\r\n\t\t\tconst pastOut = display.out && display.out < v.currentTime\r\n\t\t\tconst beforeIn = display.in && display.in > v.currentTime\r\n\t\t\tif (pastOut || beforeIn) v.currentTime = display.in || 0\r\n\t\t}\r\n\t}, [display, v, onLoad, dispatch, index])\r\n\r\n\tconst adjustDisplayTime = (adjustment:number, percentage:boolean = false) => {\r\n\t\tif (percentage) adjustment = v.duration * adjustment\r\n\t\tv.currentTime = (v.currentTime + adjustment + v.duration) % v.duration\r\n\t}\r\n\r\n\tconst shiftDisplayActions = {\r\n\t\t\"arrowleft\": () => adjustDisplayTime(-.1, true),\r\n\t\t\"arrowright\": () => adjustDisplayTime(.1, true),\r\n\t\t\"f\": () => v && fullscreenElement(v)\r\n\t}\r\n\tconst displayActions = {\r\n\t\t\"m\": () => { v.muted = !v.muted },\r\n\t\t\"arrowleft\": () => adjustDisplayTime(-60),\r\n\t\t\"arrowright\": () => adjustDisplayTime(60),\r\n\t}\r\n\r\n\tconst handleDisplayKeyDown = (ev:React.KeyboardEvent<HTMLDivElement>) =>\r\n\t\ttryActions(\r\n\t\t\tev.shiftKey ? shiftDisplayActions : displayActions,\r\n\t\t\tev.key.toLowerCase()\r\n\t\t)\r\n\r\n\treturn <div className=\"display\"\r\n\t\tonMouseOver={handleMouseOver}\r\n\t\tonMouseMove={handleMouseMove}\r\n\t\tonMouseOut={handleMouseOut}\r\n\t\tonKeyDown={handleDisplayKeyDown}>\r\n\t\t{overlayTimeout && <>\r\n\t\t\t<div className=\"display-border\" style={{pointerEvents: msBrowser ? 'none' : 'auto'}}>\r\n\t\t\t\t{display.file.name}{display.playbackRate !== 1 && ` (${display.playbackRate}x)`}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"display-controls\">\r\n\t\t\t\t<button onClick={()=>dispatch({type: 'removeActive'})}>X</button>\r\n\t\t\t\t<button onClick={()=>dispatch({type: 'copyDisplay', payload: index})}>C</button>\r\n\t\t\t\t<button onClick={() => dispatch({type: 'setExclusive', payload: index})}>E</button>\r\n\t\t\t\t<button onClick={() => dispatch({type: 'setActiveIO', payload: 'in'})}>I</button>\r\n\t\t\t\t<button onClick={() => dispatch({type: 'setActiveIO', payload: 'out'})}>O</button>\r\n\t\t\t\t<button onClick={() => dispatch({type: 'adjustActivePlaybackRate', payload: 2})}>&raquo;</button>\r\n\t\t\t\t<button onClick={() => dispatch({type: 'adjustActivePlaybackRate', payload: 0.5})}>&laquo;</button>\r\n\t\t\t</div>\r\n\t\t\t<IOBar inTime={display.in} outTime={display.out} video={v} />\r\n\t\t</>}\r\n\t\t{showThumbnail && thumbnailState && <Thumbnail src={display.url} {...thumbnailState} />}\r\n\t\t<video controls autoPlay loop muted ref={videoRef}\r\n\t\t\tsrc={display.url} draggable={!msBrowser} {...size} style={{objectFit}} />\r\n\t</div>\r\n}","import uuid from 'uuid'\r\nimport {ObjectFitProperty} from 'csstype'\r\nimport { Display } from './BDVideo'\r\nimport { toggleFullscreen } from './FullScreen'\r\nimport aspectRatios from './AspectRatios.json'\r\n\r\nexport const objectFits:ObjectFitProperty[] = ['contain', 'cover', 'fill', 'scale-down']\r\nexport type AspectRatio = typeof aspectRatios[number]\r\n\r\nconst getDisplayCopy = (display:Display) => ({\r\n\t...display,\r\n\tid: uuid(),\r\n\tstartTime: display.video ? (display.video.currentTime + 60) % display.video.duration : 0\r\n})\r\n\r\nconst getNext = <T,>(list:T[], current:T) =>\r\n\tlist[(list.indexOf(current) + 1) % list.length]\r\n\r\nconst removeIndex = <T,>(list:T[], i:number) =>\r\n\t[...list.slice(0,i), ...list.slice(i+1)]\r\n\r\ntype Viewport = {\r\n\twidth:number\r\n\theight:number\r\n}\r\n\r\ntype AppState = {\r\n\tshowHelp:boolean\r\n\tshowThumbnails:boolean\r\n\tfirstLoad:boolean\r\n\r\n\tfit:ObjectFitProperty\r\n\taspect:AspectRatio\r\n\r\n\tactiveIndex?:number\r\n\tdragSrc?:Display\r\n\r\n\tdisplays:Display[]\r\n\terrorDisplays:Display[]\r\n\r\n\tviewport?:Viewport\r\n}\r\n\r\nexport type AppAction =\r\n| { type: 'nextAspect' }\r\n| { type: 'nextFit' }\r\n| { type: 'setExclusive', payload:number }\r\n| { type: 'toggleHelp' }\r\n| { type: 'toggleThumbnails' }\r\n| { type: 'toggleFullscreen' }\r\n| { type: 'setPartialState', payload:Partial<AppState> }\r\n| { type: 'removeActive' }\r\n| { type: 'copyDisplay', payload:number }\r\n| { type: 'reorderDisplays', payload:EventTarget }\r\n| { type: 'addCopies', payload:number }\r\n| { type: 'updateDisplay', payload: {index:number, updates:Partial<Display>} }\r\n| { type: 'applyToActive', payload:(display:Display)=>Partial<Display> }\r\n| { type: 'applyToAll', payload:(display:Display)=>Partial<Display> }\r\n| { type: 'addFiles', payload:File[] }\r\n| { type: 'handleDisplayError', payload:number }\r\n| { type: 'dismissErrors' }\r\n| { type: 'distributeTimes' }\r\n| { type: 'setActiveIO', payload:'in'|'out' }\r\n| { type: 'adjustActivePlaybackRate', payload:number }\r\n| { type: 'syncPlaybackRates', payload:number }\r\n\r\nexport const AppReducer = (state:AppState, action:AppAction):AppState => {\r\n\tconst applyToActive = (modifier:(display:Display)=>Partial<Display>) => {\r\n\t\tconst i = state.activeIndex\r\n\t\tif (i === undefined) return state\r\n\t\tconst d = state.displays\r\n\t\tconst displays = [\r\n\t\t\t...d.slice(0, i),\r\n\t\t\t{...d[i], ...modifier(d[i])},\r\n\t\t\t...d.slice(i+1)\r\n\t\t]\r\n\t\treturn { ...state, displays }\r\n\t}\r\n\r\n\tconst applyToAll = (modifier:(display:Display)=>Partial<Display>) => {\r\n\t\tconst displays = state.displays.map(i=>({...i, ...modifier(i)}))\r\n\t\treturn { ...state, ...displays}\r\n\t}\r\n\r\nswitch (action.type) {\r\n\tcase 'nextAspect':\r\n\t\treturn {...state, aspect: getNext(aspectRatios, state.aspect)}\r\n\tcase 'nextFit':\r\n\t\treturn {...state, fit: getNext(objectFits, state.fit)}\r\n\tcase 'setExclusive':\r\n\t\treturn {...state, activeIndex: 0, displays: [state.displays[action.payload]]}\r\n\tcase 'toggleHelp':\r\n\t\treturn {...state, showHelp: !state.showHelp}\r\n\tcase 'toggleThumbnails':\r\n\t\treturn {...state, showThumbnails: !state.showThumbnails}\r\n\tcase 'setPartialState':\r\n\t\treturn {...state, ...action.payload}\r\n\tcase 'toggleFullscreen':\r\n\t\ttoggleFullscreen()\r\n\t\treturn state\r\n\tcase 'removeActive':\r\n\t\tif (state.activeIndex === undefined) return state\r\n\t\treturn {...state, displays: removeIndex(state.displays, state.activeIndex)}\r\n\tcase 'copyDisplay': {\r\n\t\tconst displays = [\r\n\t\t\t...state.displays,\r\n\t\t\tgetDisplayCopy(state.displays[action.payload])\r\n\t\t]\r\n\t\treturn { ...state, displays }\r\n\t}\r\n\tcase 'reorderDisplays': {\r\n\t\tconst src = state.dragSrc\r\n\t\tif (src === undefined) return state\r\n\t\tconst d = state.displays\r\n\t\tconst si = d.indexOf(src)\r\n\t\tconst di = d.findIndex(i => i.video === action.payload) || d.length - 1\r\n\t\tconst displays = si > di ? [\r\n\t\t\t...d.slice(0, di),\r\n\t\t\td[si],\r\n\t\t\t...d.slice(di, si),\r\n\t\t\t...d.slice(si+1)\r\n\t\t] : [\r\n\t\t\t...d.slice(0, si),\r\n\t\t\t...d.slice(si+1, di+1),\r\n\t\t\td[si],\r\n\t\t\t...d.slice(di+1)\r\n\t\t]\r\n\t\treturn { ...state, displays }\r\n\t}\r\n\tcase 'addCopies': {\r\n\t\tconst i = state.activeIndex\r\n\t\tif (i === undefined) return state\r\n\t\tconst displays = [\r\n\t\t\t...state.displays,\r\n\t\t\t...[...Array(action.payload)].map(()=>getDisplayCopy(state.displays[i]))\r\n\t\t]\r\n\t\treturn { ...state, displays }\r\n\t}\r\n\tcase 'updateDisplay': {\r\n\t\tconst displays = [...state.displays]\r\n\t\tconst {index, updates} = action.payload\r\n\t\tdisplays[index] = { ...displays[index], ...updates }\r\n\t\treturn { ...state, displays }\r\n\t}\r\n\t// lots of issues because active is an object, not the object in question\r\n\tcase 'applyToActive':\r\n\t\treturn applyToActive(action.payload)\r\n\tcase 'applyToAll':\r\n\t\treturn applyToAll(action.payload)\r\n\tcase 'setActiveIO': {\r\n\t\tconst marker = action.payload\r\n\t\treturn applyToActive(display => ({\r\n\t\t\t[marker]: display[marker] === undefined\r\n\t\t\t\t? display.video!.currentTime\r\n\t\t\t\t: undefined\r\n\t\t}))\r\n\t}\r\n\tcase 'addFiles': {\r\n\t\tconst newDisplays = action.payload.map(file => ({\r\n\t\t\tid: uuid(),\r\n\t\t\tfile,\r\n\t\t\turl: URL.createObjectURL(file),\r\n\t\t\t// triggerResize: state.firstLoad,\r\n\t\t\tplaybackRate: 1\r\n\t\t}))\r\n\t\treturn {\r\n\t\t\t...state,\r\n\t\t\tfirstLoad: false,\r\n\t\t\tshowHelp: state.showHelp && newDisplays.length === 0,\r\n\t\t\tdisplays: [...state.displays, ...newDisplays]\r\n\t\t}\r\n\t}\r\n\tcase 'handleDisplayError': {\r\n\t\tconst i = action.payload\r\n\t\treturn {\r\n\t\t\t...state,\r\n\t\t\terrorDisplays: [...state.errorDisplays, state.displays[i]],\r\n\t\t\tdisplays: removeIndex(state.displays, i)\r\n\t\t}\r\n\t}\r\n\tcase 'dismissErrors':\r\n\t\treturn { ...state, errorDisplays: [] }\r\n\tcase 'distributeTimes': {\r\n\t\tconst i = state.activeIndex\r\n\t\tif (i === undefined) return state\r\n\t\tconst display = state.displays[i]\r\n\t\tconst {video, file} = display\r\n\t\tif (!video) return state\r\n\r\n\t\tconst matchingDisplays = state.displays.filter(i => i.file === file)\r\n\t\t// start with target display so it keeps its current time, bump up from there looping back to start\r\n\t\tconst orderedDisplays = [\r\n\t\t\tdisplay,\r\n\t\t\t...matchingDisplays.slice(i+1),\r\n\t\t\t...matchingDisplays.slice(0, i)\r\n\t\t]\r\n\r\n\t\tconst t1 = video.currentTime\r\n\t\tconst duration = video.duration\r\n\t\tconst spacing = duration / orderedDisplays.length\r\n\r\n\t\torderedDisplays.forEach((v, i) => {\r\n\t\t\tconst targetTime = t1 + (spacing * i)\r\n\t\t\t// loop time back to beginning once we exceed end of video\r\n\t\t\tv.video!.currentTime = targetTime % duration\r\n\t\t})\r\n\t\treturn state\r\n\t}\r\n\tcase 'adjustActivePlaybackRate':\r\n\t\treturn applyToActive(\r\n\t\t\td=>({playbackRate: d.playbackRate * action.payload}))\r\n\tcase 'syncPlaybackRates':\r\n\t\treturn applyToAll(d=>({playbackRate: action.payload}))\r\n}}","import React from 'react'\r\nimport './Help.css'\r\nimport { ObjectFitProperty } from \"csstype\"\r\nimport {objectFits} from '../AppReducer'\r\nimport AspectRatios from '../AspectRatios.json'\r\ntype AspectRatio = typeof AspectRatios[number]\r\n\r\nconst SHORTCUTS = <section id=\"shortcuts\">\r\n\t<h2>Shortcuts</h2><ol>\r\n\t\t<li><em>C:</em> Clone video (+1m)</li>\r\n\t\t<li><em>D:</em> Distribute times</li>\r\n\t\t<li><em>E:</em> Remove everything else</li>\r\n\t\t<li><em>F:</em> Toggle fullscreen</li>\r\n\t\t<li><em>Shift+F:</em> Fullscreen video</li>\r\n\t\t<li><em>H:</em> Toggle help</li>\r\n\t\t<li><em>I:</em> Toggle in point</li>\r\n\t\t<li><em>O:</em> Toggle out point</li>\r\n\t\t<li><em>M:</em> Toggle mute</li>\r\n\t\t<li><em>R:</em> Remove video</li>\r\n\t\t<li><em>S:</em> Change video scaling</li>\r\n\t\t<li><em>X:</em> Change aspect ratio</li>\r\n\t\t<li><em>← →:</em> Skip 1m</li>\r\n\t\t<li><em>Shift ← →:</em> Skip 10%</li>\r\n\t\t<li><em>Ctrl ← →:</em> Change speed</li>\r\n\t\t<li><em>Shift+S</em> Sync speeds</li>\r\n\t\t<li><em>Ctrl+W:</em> Close tab</li>\r\n\t\t<li><em>O,O:</em> Restart video</li>\r\n\t\t<li><em>2-9:</em> Fill 2-9 size grid</li>\r\n\t\t<li><em>Drag+Drop:</em> Reorder videos</li>\r\n\t</ol>\r\n</section>\r\n\r\nconst DISCLAIMER = <footer>\r\n\t<h2>Privacy Disclaimer</h2>\r\n\t<p>This tool records <b>no</b> filenames, screen grabs, or any other methods of identifying the actual contents of any video.  Only metadata about a video's format (codec, file size, resolution, and duration) may be recorded.</p>\r\n</footer>\r\n\r\ntype HelpSettingsProps = {\r\n\tobjectFit:ObjectFitProperty\r\n\tobjectFitCallback:(v:ObjectFitProperty)=>void\r\n\taspectRatio:AspectRatio\r\n\taspectRatioCallback:(v:AspectRatio)=>void\r\n}\r\n\r\n// const getAR = (v:AspectRatio) => `${v.ratio.toFixed(2)} / ${v.name}`\r\n\r\nexport function Help(props:HelpSettingsProps) {\r\n\treturn <section id=\"help\">\r\n\t\t<h2>Usage</h2>\r\n\t\t<p>Drag and drop any number of videos to auto-play in an optimally arranged grid.</p>\r\n\t\t<section id=\"settings\">\r\n\t\t\t<h2>Settings</h2>\r\n\t\t\t<form>\r\n\t\t\t\t<SelectInput\r\n\t\t\t\t\tname=\"objectScale\" label=\"Video Fit/Fill\"\r\n\t\t\t\t\tvalue={props.objectFit} choices={objectFits.map(v => <option key={v} value={v}>{v[0].toUpperCase()+v.substr(1)}</option>)}\r\n\t\t\t\t\tcallback={v=>props.objectFitCallback(v as ObjectFitProperty)} /><br />\r\n\t\t\t\t<SelectInput\r\n\t\t\t\t\tname=\"aspectRatio\" label=\"Aspect Ratio\"\r\n\t\t\t\t\tvalue={AspectRatios.indexOf(props.aspectRatio).toString()}\r\n\t\t\t\t\tchoices={AspectRatios.map((v, i) => <option key={i} value={i}>{v.name}</option>)}\r\n\t\t\t\t\tcallback={i=>props.aspectRatioCallback(AspectRatios[parseInt(i)])} /><br />\r\n\t\t\t</form>\r\n\t\t</section>\r\n\t\t{SHORTCUTS}\r\n\t\t{DISCLAIMER}\r\n\t</section>\r\n}\r\n\r\nfunction SelectInput(props:{name:string, label:string, value:string, choices:JSX.Element[], callback:(val:string)=>void}) {\r\n\treturn <>\r\n\t\t<label htmlFor={props.name}>{props.label}</label>\r\n\t\t<select name={props.name} value={props.value} onChange={e => props.callback(e.target.value)}>\r\n\t\t\t{props.choices}\r\n\t\t</select>\r\n\t</>\r\n}\r\n\r\n// type NumInputProps = {\r\n// \tvalue:number\r\n// \tname:string\r\n// \tlabel:string\r\n// \tcallback:(num:number)=>void\r\n// }\r\n// const NumInput = ({value,name,label,callback}:NumInputProps) => <>\r\n// \t<label htmlFor={name}>{label}</label>\r\n// \t<input type=\"number\" min={0} maxLength={3} name={name} value={value} onChange={e => callback(parseFloat(e.target.value))} />\r\n// </>\r\n\r\nexport default Help","import React from 'react'\r\nimport {Display} from '../BDVideo'\r\n\r\ntype ErrorDisplayProps = {\r\n\terrorDisplays:Display[]\r\n\tdismissCallback:()=>void\r\n}\r\nexport function ErrorDisplay({errorDisplays, dismissCallback}:ErrorDisplayProps) {\r\n\treturn <section id=\"errors\">\r\n\t\t<h2>Errors</h2><ol>\r\n\t\t\t{errorDisplays.map((display, i) => <li key={i}>{display.file.name} ({display.file.type})</li>)}\r\n\t\t</ol>\r\n\t\t<p>Only videos supported by your web browser will play successfully.  <code>.mp4</code> and <code>.webm</code> files are good bets.</p>\r\n\t\t<form onSubmit={dismissCallback}><button>Dismiss</button></form>\r\n\t</section>\r\n}\r\n","import React from 'react'\r\n\r\n// TODO: add logo\r\nexport function Splash() {\r\n\treturn <section id=\"splash\">\r\n\t\t<p>Auto-play any number of videos or copies of videos in an optimally arranged grid with simple drag-and-drop.  Videos start half-way in and loop, ensuring immediate, continuous immersion, great for scouring surveillance footage, finding the best highlights from your last gaming stream, and more!</p>\r\n\t\t<p>Find your favourite moments quickly with thumbnail scrubbing and keyboard shortcuts to jump ahead in time 1m (→) or 10% (Shift →), or adjust playback speed (Ctrl →).</p>\r\n\t\t<p>Use shortcut keys to rapidly (c)opy or (r)emove displays, set (i)n/(o)ut loop points, (f)ullscreen the display, toggle (m)ute, etc.</p>\r\n\t\t{/* <img src=\"clipart/surveillance.jpg\" alt=\"Surveillance\" />\r\n\t\t<img src=\"clipart/television.jpg\" alt=\"Television\" /> */}\r\n\t</section>\r\n}\r\n\r\n","// TODO: import only required polyfills\n// import 'react-app-polyfill/ie11'\n// import '@babel/polyfill'\n// import 'core-js/modules/es6.array.from'\n\n// TODO: refence react as third party library on cdn?\nimport React from 'react'\nimport { BDVideo } from './BDVideo'\nimport Help from './components/Help'\nimport { ErrorDisplay } from './components/ErrorDisplay'\nimport { Splash } from './components/Splash'\nimport aspectRatios from './AspectRatios.json'\nimport './App.css'\n\nimport {getVideoSize} from './getVideoSize'\nimport { AppReducer, objectFits, AppAction } from './AppReducer'\n\nconst avg = (arr:number[]) => arr.reduce((a, b) => a + b, 0) / arr.length\n\nfunction stopEvent(e:Event) {\n\te.preventDefault()\n\te.stopPropagation()\n}\n\ntype ActionSet = {[key:string]:AppAction}\n\nfunction App() {\n\tconst [{displays, ...state}, dispatch] = React.useReducer(AppReducer, {\n\t\tshowHelp: true,\n\t\tshowThumbnails: true,\n\t\tfirstLoad: true,\n\t\tdisplays: [],\n\t\terrorDisplays: [],\n\t\taspect: aspectRatios[0],\n\t\tfit: objectFits[0]\n\t})\n\n\tconst viewport = React.useRef<HTMLElement>(null)\n\n\tconst globalActions:ActionSet = {\n\t\t\"f\": {type: 'toggleFullscreen'},\n\t\t\"h\": {type: 'toggleHelp'},\n\t\t\"s\": {type: 'nextFit'},\n\t\t\"t\": {type: 'toggleThumbnails'},\n\t\t\"x\": {type: 'nextAspect'}\n\t}\n\n\tReact.useLayoutEffect(() => {\n\t\tconst handleResize = () => {\n\t\t\tconst i = viewport.current!\n\t\t\tconst payload = {\n\t\t\t\tviewport: {\n\t\t\t\t\twidth: i.clientWidth,\n\t\t\t\t\theight: i.clientHeight\n\t\t\t\t}\n\t\t\t}\n\t\t\tdispatch({ type: 'setPartialState', payload })\n\t\t}\n\t\twindow.onresize = () => handleResize()\n\t\thandleResize()\n\t\t// eslint-disable-next-line\n\t}, [])\n\n\tReact.useEffect(() => {\n\t\tdocument.ondragover = stopEvent\n\t\tdocument.ondragenter = stopEvent\n\t\tdocument.ondragleave = stopEvent\n\t}, [])\n\n\tReact.useEffect(() => {\n\t\twindow.onkeydown = (ev) => {\n\t\t\tconst key = ev.key.toLowerCase()\n\t\t\tif (key in globalActions && !ev.shiftKey && !ev.ctrlKey) {\n\t\t\t\treturn dispatch(globalActions[key])\n\t\t\t}\n\n\t\t\tconst i = state.activeIndex\n\t\t\tif (i === undefined) return\n\t\t\tconst ctrlDisplayActions:ActionSet = {\n\t\t\t\t\"arrowleft\": {type: 'adjustActivePlaybackRate', payload: 0.5},\n\t\t\t\t\"arrowright\": {type: 'adjustActivePlaybackRate', payload: 2}\n\t\t\t}\n\t\t\tconst shiftDisplayActions:ActionSet = {\n\t\t\t\t\"s\": {type: 'syncPlaybackRates', payload: displays[i].video!.playbackRate}\n\t\t\t}\n\t\t\tconst displayActions:ActionSet = {\n\t\t\t\t\"delete\": {type: 'removeActive'},\n\t\t\t\t\"c\": {type: 'copyDisplay', payload: i},\n\t\t\t\t\"d\": {type: 'distributeTimes', payload: i},\n\t\t\t\t\"e\": {type: 'setExclusive', payload: i},\n\t\t\t\t\"i\": {type: 'setActiveIO', payload: 'in'},\n\t\t\t\t\"o\": {type: 'setActiveIO', payload: 'out'},\n\t\t\t\t\"r\": {type: 'removeActive'},\n\t\t\t}\n\n\t\t\tif (ev.shiftKey) {\n\t\t\t\tkey in shiftDisplayActions && dispatch(shiftDisplayActions[key])\n\t\t\t} else if (ev.ctrlKey) {\n\t\t\t\tkey in ctrlDisplayActions && dispatch(ctrlDisplayActions[key])\n\t\t\t} else {\n\t\t\t\tkey in displayActions && dispatch(displayActions[key])\n\t\t\t\tif (key >= \"1\" && key <= \"9\") {\n\t\t\t\t\tdispatch({type: 'addCopies', payload: parseInt(key)})\n\t\t\t\t\tdispatch({type: 'distributeTimes', payload: i})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, [displays, state.activeIndex, globalActions])\n\n\tReact.useEffect(() => {\n\t\tdocument.ondrop = e => {\n\t\t\tstopEvent(e)\n\t\t\tif (!e.dataTransfer) return\n\t\t\tconst droppedFiles = e.dataTransfer.files as FileList\n\t\t\tdispatch({type: 'addFiles', payload: Array.from(droppedFiles)})\n\t\t}\n\t}, [])\n\n\tconst getRecommendedAspect = () => {\n\t\tconst avgRatio = avg(displays.map(i => i.video!.videoWidth / i.video!.videoHeight))\n\t\tconst closestRatio = [...aspectRatios].sort((a, b) => Math.abs(avgRatio - b.ratio) - Math.abs(avgRatio - a.ratio)).pop()!\n\t\treturn closestRatio\n\t}\n\n\tconst size = React.useMemo(() => getVideoSize(\n\t\tstate.aspect.ratio,\n\t\tdisplays.length,\n\t\tstate.viewport || {width: 1, height: 1}\n\t), [state.aspect, displays, state.viewport])\n\n\treturn <>\n\t\t<main ref={viewport} onDrop={e => dispatch({type: 'reorderDisplays', payload: e.target})}>\n\t\t\t{displays.length === 0 && <Splash />}\n\t\t\t{displays.map((d, i) => <BDVideo key={d.id} size={size} objectFit={state.fit} display={d}\n\t\t\t\tshowThumbnail={state.showThumbnails}\n\t\t\t\t// TODO: should wait for load of all videos instead of calcualting after each one\n\t\t\t\tonLoad={() => dispatch({type: 'setPartialState', payload: {aspect: getRecommendedAspect()}})}\n\t\t\t\tdispatch={dispatch}\n\t\t\t\tindex={i}\n\t\t\t/>)}\n\t\t</main>\n\t\t{state.errorDisplays.length > 0 && <ErrorDisplay errorDisplays={state.errorDisplays} dismissCallback={()=>dispatch({type: 'dismissErrors'})} />}\n\t\t{state.showHelp && <Help\n\t\t\taspectRatio={state.aspect}\n\t\t\tobjectFit={state.fit}\n\t\t\taspectRatioCallback={i=>dispatch({type: 'setPartialState', payload: {aspect: i}})}\n\t\t\tobjectFitCallback={i=>dispatch({type: 'setPartialState', payload: {fit: i}})} />}\n\t</>\n}\n\nexport default App","export function getVideoSize(aspectRatio:number, objects:number, constraints:{width:number,height:number}) {\r\n\t// try every number of rows up to a dedicated row for each video\r\n\tlet bestArea = 0, width = 0, height = 0\r\n\tfor (let rows = 1; rows <= objects; rows++) {\r\n\t\t// get the necessary number of columns with a given number of rows\r\n\t\tconst cols = Math.ceil(objects / rows)\r\n\t\t// this determines the size of the resulting box\r\n\t\tconst x = Math.floor(constraints.width / cols)\r\n\t\tconst y = Math.floor(constraints.height / rows)\r\n\t\t// actual video dimensions will depend on ratio within the display box, being shrunk on one side\r\n\t\tlet vx = x, vy = y\r\n\t\tif (aspectRatio > x/y) {\r\n\t\t\tvy = vx / aspectRatio\r\n\t\t} else {\r\n\t\t\tvx = vy * aspectRatio\r\n\t\t}\r\n\t\tconst videoArea = vx * vy\r\n\t\t// if this isn't an improvement, continue looking\r\n\t\tif (videoArea < bestArea) continue\r\n\t\t// otherwise save this as best situation\r\n\t\tbestArea = videoArea\r\n\t\twidth = x\r\n\t\theight = y\r\n\t}\r\n\r\n\treturn {width, height}\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === '[::1]' ||\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\n\t\twindow.location.hostname.match(\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n\t\t)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error('Error during service worker registration:', error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl)\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get('content-type');\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null && contentType.indexOf('javascript') === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log(\n\t\t\t\t'No internet connection found. App is running in offline mode.'\n\t\t\t);\n\t\t});\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\tregistration.unregister();\n\t\t});\n\t}\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister()\nserviceWorker.register()\n"],"sourceRoot":""}