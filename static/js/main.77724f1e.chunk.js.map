{"version":3,"sources":["AspectRatio.ts","App.tsx","serviceWorker.js","index.js"],"names":["ASPECT_RATIOS","ratio","name","OBJECT_FITS","stopDragDrop","e","preventDefault","stopPropagation","adjustDisplayTime","display","adjustment","vid","video","diff","seekable","end","currentTime","BDVideo","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","initialLoad","_this2","_this$props","size","onMouseOver","onMouseOut","objectFit","react_default","a","createElement","assign","className","style","width","concat","height","controls","autoPlay","loop","muted","src","url","ref","i","setVideo","_this$props2","onLoad","startTime","onloadeddata","onloadedmetadata","setState","React","Component","App","_this3","viewport","globalActions","f","document","fullscreenEnabled","fullscreenElement","exitFullscreen","body","requestFullscreen","h","showHelp","showInfo","s","nextObjectFit","x","nextDimensionRatio","createRef","displays","maxId","ratioIndex","aspectRatio","objectFitIndex","firstBatch","window","onresize","updateDimensions","onkeydown","ev","key","altCase","toLowerCase","toUpperCase","activeDisplay","displayActions","Delete","deleteDisplay","d","c","copyDisplay","ArrowLeft","ArrowRight","m","ondragover","ondragenter","ondragleave","ondrop","dataTransfer","droppedFiles","files","videoFiles","Array","from","filter","type","startsWith","newDisplays","map","file","id","URL","createObjectURL","triggerResize","length","_this$state","y","smallest","bestrows","bestcols","rows","cols","Math","ceil","min","vp","current","clientWidth","clientHeight","activeVideo","newDisplay","videoWidth","videoHeight","avgRatio","getAspectRatios","reduce","b","closestRatio","toConsumableArray","sort","pop","findIndex","getRecommendedAspectRatioIndex","_this4","_this$state2","getVideoSize","Fragment","App_BDVideo","undefined","setRecommendedAspectRatio","Boolean","location","hostname","match","ReactDOM","render","src_App_0","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.77724f1e.chunk.js","sourcesContent":["export interface AspectRatio {\r\n\tratio:number,\r\n\tname:string\r\n}\r\n\r\nexport const ASPECT_RATIOS = [\r\n\t{\r\n\t\tratio: 16/9,\r\n\t\tname: \"16:9 (High Definition)\"\r\n\t}, {\r\n\t\tratio: 4/3,\r\n\t\tname: \"4:3 (Standard Definition)\"\r\n\t}, {\r\n\t\tratio: 1,\r\n\t\tname: \"1:1 (Square)\",\r\n\t}, {\r\n\t\tratio: 9/16,\r\n\t\tname: \"9:16 (Vertical HD)\"\r\n\t}, {\r\n\t\tratio: 1.85,\r\n\t\tname: \"1.85:1 (Cinematic Wide)\"\r\n\t}, {\r\n\t\tratio: 2.35,\r\n\t\tname: \"2.35:1 (Anamorphic Wide)\"\r\n\t}\r\n]","import React from 'react'\nimport './App.css'\nimport {AspectRatio, ASPECT_RATIOS} from './AspectRatio'\n\n// remember help display setting?  Or hide on add video?  hide on add only if already hidden?\n// add logo\n// add whole thing as repository and configure gh-pages deploy\n// make commands responsive when no video present\n// refence react as third party library on cdn?\n\ntype ObjectFit = \"fill\"|\"contain\"|\"cover\"|\"scale-down\"\nconst OBJECT_FITS = ['contain', 'cover', 'fill', 'scale-down'] as ObjectFit[]\n\nfunction stopDragDrop(e:Event) {\n\te.preventDefault()\n\te.stopPropagation()\n}\n\nfunction toggleMute(video?:HTMLVideoElement) {\n\tif (!video) return\n\tvideo.muted = !video.muted\n}\n\nfunction adjustDisplayTime(display:Display, adjustment:number) {\n\tconst vid = display.video\n\tif (!vid) return\n\tlet end = vid.seekable.end(0)\n\tlet diff = end - vid.currentTime\n\tif (adjustment > diff) {\n\t\tvid.currentTime = adjustment - diff\n\t} else {\n\t\tvid.currentTime = vid.currentTime + adjustment\n\t}\n}\n\ninterface Display {\n\tid:number,\n\tfile:File,\n\turl:string,\n\tstartTime?:number,\n\tvideo?:HTMLVideoElement,\n\ttriggerResize:boolean\n}\n\ninterface BDVideoProps {\n\tdisplay:Display,\n\tobjectFit:ObjectFit,\n\tsize: {\n\t\twidth: number,\n\t\theight: number\n\t},\n\tonMouseOver:()=>void,\n\tonMouseOut:()=>void,\n\tonLoad:()=>void\n}\n\ninterface BDVideoState {\n\tinitialLoad:boolean\n}\n\nclass BDVideo extends React.Component<BDVideoProps, BDVideoState> {\n\tconstructor(props:BDVideoProps) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tinitialLoad: true\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {size, onMouseOver, onMouseOut, display, objectFit} = this.props\n\n\t\treturn <div className=\"display\" {...size} onMouseOver={onMouseOver} onMouseOut={onMouseOut}>\n\t\t\t<div className=\"display-border\" style={{width: `${size.width}px`, height: `${size.height}px`}}></div>\n\t\t\t<video controls={true} autoPlay={true} loop={true} muted={true} src={display.url}\n\t\t\t{...size} ref={i => i && this.setVideo(i)} style={{objectFit}} />\n\t\t</div>\n\t}\n\n\tsetVideo(video:HTMLVideoElement) {\n\t\tconst {initialLoad} = this.state\n\t\tif (!initialLoad) return\n\t\tconst {display, onLoad} = this.props\n\t\tdisplay.video = video\n\t\tif (display.startTime) {\n\t\t\tvideo.currentTime = display.startTime\n\t\t} else {\n\t\t\tvideo.onloadeddata = e => video.currentTime = video.seekable.end(0) / 2\n\t\t\tvideo.onloadedmetadata = e => onLoad()\n\t\t}\n\t\tthis.setState({initialLoad: false})\n\t}\n}\n\ninterface Dimensions {\n\tx:number,\n\ty:number\n}\n\ninterface AppState {\n\tshowInfo:boolean,\n\tshowHelp:boolean,\n\tdisplays:Display[],\n\tmaxId:number,\n\tactiveDisplay?:Display,\n\tviewport?:Dimensions,\n\tratioIndex:number,\n\taspectRatio:AspectRatio,\n\tobjectFitIndex:number,\n\tobjectFit:ObjectFit,\n\tfirstBatch:boolean\n}\n\ninterface ActionControls {\n\t[key:string]: ()=>void\n}\n\nfunction toggleFullscreen() {\n\tif (!document.fullscreenEnabled) return\n\tif (document.fullscreenElement) {\n\t\tdocument.exitFullscreen()\n\t} else {\n\t\tdocument.body.requestFullscreen()\n\t}\n}\n\nclass App extends React.Component<{},AppState> {\n\tviewport:React.RefObject<HTMLElement>\n\tglobalActions = {\n\t\t\"f\": () => toggleFullscreen(),\n\t\t\"h\": () => this.setState({showHelp: !this.state.showHelp}),\n\t\t\"i\": () => this.setState({showInfo: !this.state.showInfo}),\n\t\t\"s\": () => this.nextObjectFit(),\n\t\t\"x\": () => this.nextDimensionRatio()\n\t} as ActionControls\n\n\tconstructor(props:{}) {\n\t\tsuper(props)\n\t\tthis.viewport = React.createRef<HTMLElement>()\n\t\tthis.state = {\n\t\t\tshowInfo: false,\n\t\t\tshowHelp: true,\n\t\t\tdisplays: [],\n\t\t\tmaxId: 0,\n\t\t\tratioIndex: 0,\n\t\t\taspectRatio: ASPECT_RATIOS[0],\n\t\t\tobjectFitIndex: 0,\n\t\t\tobjectFit: OBJECT_FITS[0],\n\t\t\tfirstBatch: true\n\t\t}\n\n\t\twindow.onresize = () => this.updateDimensions()\n\n\t\twindow.onkeydown = ev => {\n\t\t\tconst key = ev.key\n\t\t\tconst altCase = key.toLowerCase() == key ? key.toUpperCase() : key.toLowerCase()\n\t\t\t\n\t\t\tif (key in this.globalActions) {\n\t\t\t\tthis.globalActions[key]()\n\t\t\t\treturn\n\t\t\t} else if (altCase in this.globalActions) {\n\t\t\t\tthis.globalActions[altCase]()\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst {activeDisplay} = this.state\n\t\t\tif (!activeDisplay) return\n\n\t\t\tconst displayActions = {\n\t\t\t\t\"Delete\": () => this.deleteDisplay(activeDisplay),\n\t\t\t\t\"d\": () => this.deleteDisplay(activeDisplay),\n\t\t\t\t\"c\": () => this.copyDisplay(activeDisplay),\n\t\t\t\t\"ArrowLeft\": () => adjustDisplayTime(activeDisplay, -60),\n\t\t\t\t\"ArrowRight\": () => adjustDisplayTime(activeDisplay, 60),\n\t\t\t\t\"m\": () => toggleMute(activeDisplay.video)\n\t\t\t} as ActionControls\n\n\t\t\tif (key in displayActions) {\n\t\t\t\tdisplayActions[key]()\n\t\t\t} else if (altCase in displayActions) {\n\t\t\t\tdisplayActions[altCase]()\n\t\t\t}\n\t\t}\n\n\t\tdocument.ondragover = stopDragDrop\n\t\tdocument.ondragenter = stopDragDrop\n\t\tdocument.ondragleave = stopDragDrop\n\n\t\tdocument.ondrop = (e:DragEvent) => {\n\t\t\tstopDragDrop(e)\n\t\t\tif (!e.dataTransfer) return\n\t\t\tconst {firstBatch} = this.state\n\t\t\tlet droppedFiles = e.dataTransfer.files as FileList\n\t\t\tconst videoFiles = Array.from(droppedFiles).filter(i => i.type.startsWith('video/'))\n\t\t\tlet maxId = this.state.maxId\n\t\t\tconst newDisplays = videoFiles.map(file => { return {\n\t\t\t\tid: ++maxId,\n\t\t\t\tfile,\n\t\t\t\turl: URL.createObjectURL(file),\n\t\t\t\ttriggerResize: firstBatch\n\t\t\t} as Display})\n\n\t\t\tthis.setState({\n\t\t\t\tdisplays: this.state.displays.concat(newDisplays),\n\t\t\t\tmaxId,\n\t\t\t\tfirstBatch: false,\n\t\t\t\t// hide help if we are adding videos\n\t\t\t\tshowHelp: this.state.showHelp && videoFiles.length == 0\n\t\t\t})\n\t\t}\n\t}\n\n\tgetVideoSize() {\n\t\tconst {displays, aspectRatio, viewport} = this.state\n\t\tif (!viewport) return {width: 1, height: 1}\n\t\tif (displays.length < 2) return {width: viewport.x, height: viewport.y}\n\n\t\tlet smallest = 0, bestrows = 0, bestcols = 0\n\t\tfor (let rows = 1; rows < displays.length; rows++) {\n\t\t\tlet cols = Math.ceil(displays.length / rows)\n\t\t\tlet x = viewport.x / cols\n\t\t\tlet y = viewport.y * aspectRatio.ratio / rows\n\n\t\t\t// if neither are smaller, replace\n\t\t\tif (smallest <= x && smallest <= y) {\n\t\t\t\tsmallest = Math.min(x, y)\n\t\t\t\tbestrows = rows\n\t\t\t\tbestcols = cols\n\t\t\t} else {\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\twidth: viewport.x / bestcols,\n\t\t\theight: viewport.y / bestrows\n\t\t}\n\t}\n\n\tupdateDimensions() {\n\t\tconst vp = this.viewport.current!\n\t\tconst viewport = {x: vp.clientWidth, y: vp.clientHeight}\n\t\tthis.setState({viewport})\n\t}\n\n\tcopyDisplay(display:Display) {\n\t\tconst activeVideo = display.video\n\t\tconst maxId = this.state.maxId + 1\n\t\tlet startTime = activeVideo!.currentTime + 60\n\t\tif (startTime > activeVideo!.seekable.end(0)) startTime = 0\n\t\tconst newDisplay = {\n\t\t\tid: maxId,\n\t\t\tfile: display.file,\n\t\t\turl: display.url,\n\t\t\tstartTime,\n\t\t\ttriggerResize: false\n\t\t}\n\t\tthis.setState({ maxId, displays: this.state.displays.concat(newDisplay)})\n\t}\n\n\tdeleteDisplay(display:Display) {\n\t\tthis.setState({ displays: this.state.displays.filter(i => i != display) })\n\t}\n\n\tnextDimensionRatio() {\n\t\tlet i = this.state.ratioIndex + 1\n\t\tif (i >= ASPECT_RATIOS.length) i = 0\n\t\tthis.setState({\n\t\t\tratioIndex: i,\n\t\t\taspectRatio: ASPECT_RATIOS[i]\n\t\t})\n\t}\n\n\tnextObjectFit() {\n\t\tlet i = this.state.objectFitIndex + 1\n\t\tif (i >= OBJECT_FITS.length) i = 0\n\t\tthis.setState({\n\t\t\tobjectFitIndex: i,\n\t\t\tobjectFit: OBJECT_FITS[i]\n\t\t})\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.updateDimensions()\n\t}\n\n\tgetAspectRatios() {\n\t\treturn this.state.displays.map(i => i.video!.videoWidth / i.video!.videoHeight)\n\t}\n\n\tgetRecommendedAspectRatioIndex() {\n\t\tconst avgRatio = this.getAspectRatios().reduce((a,b) => a + b, 0) / this.state.displays.length\n\t\tconst closestRatio = [...ASPECT_RATIOS].sort((a, b) => Math.min(a.ratio / avgRatio, avgRatio / a.ratio) - Math.min(b.ratio/avgRatio, avgRatio / b.ratio)).pop()\n\t\tconst i = ASPECT_RATIOS.findIndex(i => i.name == closestRatio!.name)\n\t\treturn i\n\t}\n\n\tsetRecommendedAspectRatio() {\n\t\tconst i = this.getRecommendedAspectRatioIndex()\n\t\tthis.setState({\n\t\t\taspectRatio: ASPECT_RATIOS[i],\n\t\t\tratioIndex: i\n\t\t})\n\t}\n\n\trender() {\n\t\tconst {displays, activeDisplay, showInfo, showHelp, aspectRatio, objectFit} = this.state\n\t\tconst size = this.getVideoSize()\n\t\treturn <>\n\t\t\t{showInfo && activeDisplay && <div id=\"info-toggle\">\n\t\t\t\t{aspectRatio.name}<br />\n\t\t\t\tScale strategy: {objectFit}<br />\n\t\t\t\t{activeDisplay.file.name}\n\t\t\t</div>}\n\t\t\t<main ref={this.viewport}>\n\t\t\t\t{displays.map(i => <BDVideo size={size} objectFit={objectFit} key={i.id} display={i}\n\t\t\t\t\tonMouseOver={() => this.setState({activeDisplay: i})}\n\t\t\t\t\tonMouseOut={() => this.setState({activeDisplay: undefined})}\n\t\t\t\t\tonLoad={() => i.triggerResize && this.setRecommendedAspectRatio()} />)}\n\t\t\t</main>\n\t\t\t{showHelp && <section id=\"help\">\n\t\t\t\t<h2>Usage</h2>\n\t\t\t\t<p>Drag and drop any number of videos to auto-play in an optimally arranged grid.</p>\n\t\t\t\t<p>Videos start half-way in and loop, ensuring immediate, continuous action, but also start muted to avoid chaotic, clashing audio and prevent disturbing others.</p>\n\t\t\t\t<h2>Shortcuts</h2><ol>\n\t\t\t\t\t<li><em>C:</em> Clone video (+1m)</li>\n\t\t\t\t\t<li><em>D:</em> Delete video</li>\n\t\t\t\t\t<li><em>H:</em> Toggle help</li>\n\t\t\t\t\t<li><em>I:</em> Toggle info overlay</li>\n\t\t\t\t\t<li><em>M:</em> Toggle mute</li>\n\t\t\t\t\t<li><em>S:</em> Change video scaling</li>\n\t\t\t\t\t<li><em>X:</em> Change aspect ratio</li>\n\t\t\t\t\t<li><em>← →:</em> Skip 1m</li>\n\t\t\t\t\t<li><em>Ctrl+W:</em> Close tab</li>\n\t\t\t\t\t<li><em>F / F11:</em> Toggle fullscreen</li>\n\t\t\t\t</ol>\n\t\t\t</section>}\n\t\t</>\n\t}\n}\n\nexport default App","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}